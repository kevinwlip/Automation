##### common rules start

#Hunting Rules
#Dan - 03/21/2017
#alert tcp [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any -> any any (msg:"ZB ELF_binary.HTTP_Download.Suspicious"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; content:"|0d 0a 0d 0a 7f 45 4c 46|"; distance:0; within:360; sid:8000000; rev:1; )
#alert tcp any any -> any any (msg:"ZB ELF_Binary.Download.Suspicious"; flow:to_client,established; content:"|7f 45 4c 46|"; depth:4; sid:8000001; rev:1;)

# Anonymous FTP
#alert tcp any any -> any 21 (msg:"ZB FTP.Anonymous.LoginAttempt, extract = true"; flow:to_server,established; content:"USER"; fast_pattern:only; pcre:"/^USER\s+(anonymous|ftp)[^\w]*[\r\n]/smi"; sid:8000002; rev:1;)
# TELNET LOGIN
#alert tcp any 23 -> any any (msg:"ZB TELNET.LoginAttempt"; flow:to_client,established; content:"login|3A|"; fast_pattern:only; sid:8000003; rev:1;)

#alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"ZB Wget.Traffic.Suspicious, extract=false"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1.1|0d 0a|"; distance:0; content:"User-Agent: Wget/"; fast_pattern; distance:0;  sid:8000005; rev:1; )
#alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"ZB Curl.Traffic.Suspicious, extract=false"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1.1|0d 0a|"; distance:0; content:"User-Agent: curl/"; fast_pattern; distance:0;  content:!"curl/7.29.0"; sid:8000006; rev:1; )
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] [6667,6668,6669,6697,7000] (msg:"ZB IRC.Traffic.Suspicious"; content:"NICK"; nocase; content:"USER"; nocase; content:"NOTICE"; nocase; content:!"GET "; depth:4; content:!"POST "; depth:5; sid:8000007; rev:1; )
#Dan - 03/21/2017
alert udp any any -> any any (msg:"ZB Hajime.P2P.IoT"; content:"|00 00 00 21 00 00 c0 dd 26 97 c4 a1 7d f8 3f 36 a9 97 99 dd 38 49 58 72 84 90 fa c7 d1 31 82 05 2d 88 4e 6e 42 84|"; sid:8000008; rev:1; )
alert tcp any any -> any 23 (msg:"ZB Hajime.Bot.IoT"; flow:to_server,established; content:"/bin/busybox ECCHI"; sid:8000009; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"ZB Lightaidra.Bot.IoT"; flow:to_server,established; content:"|56 45 52 53 4f 4e 45 58 3a 4c 69 6e 75 78 2d|"; depth:15; fast_pattern; sid:8000010; rev:1; )
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"ZB SpikeDDoS.Bot.IoT"; dsize:1024; content:"VERSONEX|3a|"; nocase; offset:0; depth:9; content:"MHz|7c|"; nocase; distance:4; within:48; content:"MB|7C|"; nocase; distance:3; within:8; content:"|00 00 00 00 00 00|"; distance:32; within:32; sid:8000018; rev:1;)
#PlugX:
alert tcp any any -> any [53,80,443,5432] (msg:"ZB Trojan.Plugx.Callback"; flow:to_server,established; content:"HHV1:"; content:"HHV2:"; within:20; content:"HHV3: 61456"; within:20; fast_pattern; content:"HHV4:"; within:20; reference:url,virustotal.com/en/file/4d464f9def2276dac15d19ccf049b7c68642290bc0e345e06d4b6e9103fde9e6/analysis/; sid:8000019; rev:1;)
#Moose v1:
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Moose.Callback.IoT"; flow:established,to_server; content:"GET "; depth:4; content:".php?p="; distance:0; fast_pattern; content:"&f="; distance:0; content:"&m="; distance:0; content:!"|0d 0a|User-Agent|3a|"; content:!"|0d 0a|Accept|3a|"; content:!"|0d 0a|Referer|3a|"; reference:url,welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf; sid:8000020; rev:1;)

alert tcp any $HTTP_PORTS -> any any (msg:"ZB Moose.Callback.IoT"; flow:established,from_server; content:"Server|3a 20|Apache/20.2.25 (RedHat|29 0d 0a|"; fast_pattern:13,20; reference:url,welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf; sid:8000021; rev:1;)
alert tcp any any -> any any (msg:"ZB Moose.TelnetBeacon.IoT"; flow:established,to_server; dsize:40; content:"|0e 00 00 00|"; offset:4; depth:4; fast_pattern; content:!"|00|"; within:1; content:!"|00|"; distance:3; within:1; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:4; within:28; content:!"|00 00 00 00|"; depth:4; reference:url,welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf; sid:8000022; rev:1;)

#Dan - 03/30/2017
alert tcp any any -> any any (msg:"ZB Telnetd.ReverseShell.IoT"; flow:to_server,established; content:"telnetd -d -l /bin/sh"; depth:30; fast_pattern; sid:8000023; rev:1; )

#04/14/2017
alert tcp any any -> any any (msg:"ZB Amnesia.ReverseShell.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/language/"; distance:0; content:"${IFS}&&"; distance:0; fast_pattern; content:"echo${IFS}"; distance:0; content:"/string.js HTTP/1."; distance:0; sid:8000024; rev:1; )
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 976 (msg:"ZB SpyBot.IRC_Traffic.IoT"; dsize:<30; content:"PASS "; nocase; depth:5; content:!"GET "; depth:4; content:!"POST "; depth:5; sid:8000025; rev:1; )
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"ZB IRC.Traffic.Suspicious"; dsize:<230; content:"NICK ["; nocase;  depth:6; content:"|0a|USER "; distance:0;content:!"GET "; depth:4; content:!"POST "; depth:5; sid:8000026; rev:1; )

#Dan 04/19/17
alert udp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"ZB Hajime.P2P.IoT"; flow:to_server,established; dsize:<31; content:"|41 02|"; rawbytes; depth:2; content:"|00 00 00 00 00 38|"; rawbytes; distance:0; content:"| 00 00 00 00 00 08 00 00 00 00 00 00 00 00|"; rawbytes; distance:0; sid:8000028; rev:1;)
#Dan 04/25/2017
alert tcp any any -> any any (msg:"ZB Mirai.WiFiCAM.Exploit.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/set_ftp.cgi?next_url=ftp.htm&loginuse=admin&loginpas=admin&svr="; distance:0; fast_pattern; content:" HTTP/1."; distance:0; sid:8000029; rev:1;)
#Dan 04/26/2017
alert tcp any any -> any any (msg:"ZB Shishiga.LUABot.IoT"; flow:from_server,established; content:"HTTP/1.0 404 OK|0d 0a|Content-Length: "; fast_pattern; content:"|0d 0a|Connection: close|0d 0a 0d 0a|";  sid:8000030; rev:1;)
#Dan 04/28/2017
alert tcp any any -> any any (msg:"ZB Zyarinig.AVTECH.Exploit.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/cgi-bin/user/Config.cgi?/nobody&action="; fast_pattern; distance:0; content:"&category="; distance:0; content:" HTTP/1."; distance:0; sid:8000031; rev:1;)
alert tcp any any -> any any (msg:"ZB Zyarinig.AVTECH.Exploit.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/cgi-bin/supervisor/PwdGrp.cgi?action="; fast_pattern; distance:0; content:"&user="; distance:0; content:"&pwd="; distance:0; content:"&grp="; distance:0; content:" HTTP/1."; distance:0; sid:8000032; rev:1;)
#Dan 05/09/2017
alert tcp any any -> any any (msg:"ZB Rakos.Bot.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/love HTTP/1."; distance:0; content:"|0d 0a|User-Agent: Go-http-client/1.1|0d 0a|"; fast_pattern; distance:0; sid:8000033; rev:1;)
#alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"ZB Rakos.Bot.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"|0d 0a|User-Agent: Go-http-client/1.1|0d 0a|"; fast_pattern; distance:0; sid:8000034; rev:1;)
alert tcp any 139 -> any any (msg:"ZB Login_Bruteforce_NETBIOS"; flow:to_client,established; content:"|FF|SMBs"; depth:5; offset:4; content:"m|00 00 C0|"; within:4; detection_filter:track by_dst,count 30,seconds 30; sid:8000035; rev:1;)
alert tcp any 445 -> any any (msg:"ZB Login_Bruteforce_NETBIOS"; flow:to_client,established; content:"|FF|SMBs"; depth:5; offset:4; content:"m|00 00 C0|"; within:4; detection_filter:track by_dst,count 30,seconds 30; sid:8000036; rev:1;)

#Dan 05/12/2017
alert tcp any any -> any any (msg:"ZB ETERNALBLUE_MS17-010_HeapSpray, fastpath=true"; flow:to_server,established; content:"|ff|SMB|33 00 00 00 00 18 07 c0 00 00 00 00 00 00 00 00 00 00 00 00 00|"; offset:4; depth:25; content:"|08 ff fe 00 08 41 00 09 00 00 00 10|"; within:12; fast_pattern; content:"|00 00 00 00 00 00 00 10|"; within:8; content:"|00 00 00 10|"; distance:4; within:4; pcre:"/^[a-zA-Z0-9+/]{1000,}/R"; threshold: type threshold, track by_src, count 12, seconds 2; sid:8000037; rev:1;)
alert tcp any any -> any any (msg:"ZB ETERNALBLUE_MS17-010_EchoRequest, fastpath=true"; flow:to_server,established; content:"|00 00 00 31 ff|SMB|2b 00 00 00 00 18 07 c0|"; depth:16; fast_pattern; content:"|4a 6c 4a 6d 49 68 43 6c 42 73 72 00|"; distance:0; flowbits:set,ETPRO.ETERNALBLUE; flowbits:noalert; sid:8000038; rev:1;)
alert tcp any any -> any any (msg:"ZB ETERNALBLUE_MS17-010_EchoResponse, fastpath=true"; flow:from_server,established; content:"|00 00 00 31 ff|SMB|2b 00 00 00 00 98 07 c0|"; depth:16; fast_pattern; content:"|4a 6c 4a 6d 49 68 43 6c 42 73 72 00|"; distance:0; flowbits:isset,ETPRO.ETERNALBLUE; sid:8000039; rev:1;)
alert tcp any any -> any 445 (msg:"ZB ETERNALBLUE_MS17-010_SMB_RemoteExecution, fastpath=true"; flow:to_server,established; content:"|FF|SMB3|00 00 00 00|"; depth:9; offset:4; byte_extract:2,26,TotalDataCount,relative,little; byte_test:2,>,TotalDataCount,20,relative,little; reference:cve,2017-0144; reference:cve,2017-0146; reference:url,isc.sans.edu/forums/diary/ETERNALBLUE+Possible+Window+SMB+Buffer+Overflow+0Day/22304/; sid:8000040; rev:1;)
alert tcp any any -> any 445 (msg:"ZB DOUBLEPULSAR.Ping"; flow:to_server,established; content:"|FF|SMB|32 00 00 00 00|"; depth:9; offset:4; content:"|41 00|"; within:2; distance:21; content:"|0E 00 0D 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:17; distance:29; flowbits:set,smb.trans2.mid65; flowbits:noalert; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; sid:8000041; rev:1;)
alert tcp any any -> any 445 (msg:"ZB DOUBLEPULSAR.Injection, extract=true"; flow:to_server,established; content:"|FF|SMB|32 00 00 00 00|"; depth:9; offset:4; content:"|42 00|"; within:2; distance:21; content:"|0E 00|"; within:2; distance:29; content:!"|00 00|"; within:2; flowbits:set,smb.trans2.mid66; flowbits:noalert; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; sid:8000042; rev:1;)
alert tcp any 445 -> any any (msg:"ZB DOUBLEPULSAR.InjectionResponse, fastpath=true"; flow:to_client,established; flowbits:isset,smb.trans2.mid66; content:"|FF|SMB|32 02 00 00 C0|"; depth:9; offset:4; content:"|52 00 00 00 00|"; within:5; distance:21; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; sid:8000043; rev:1;)
alert tcp any 445 -> any any (msg:"ZB DOUBLEPULSAR.PingResponse, fastpath=true"; flow:to_client,established; flowbits:isset,smb.trans2.mid65; content:"|FF|SMB|32 02 00 00 C0|"; depth:9; offset:4; content:"|51 00 00 00 00|"; within:5; distance:21; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; sid:8000044; rev:1;)

#Dan 05/18/2017
alert tcp any any -> any any (msg:"ZB ETERNALROCK_Callback"; flow:to_server,established; content:"GET "; depth:4; content:"/updates/shadowsinstalled?version="; distance:0; content:" HTTP/1."; distance:0; sid:8000045; rev:1;)
#Dan 05/20/2017
alert tcp any 23 -> any any (msg:"ZB Login_Bruteforce_TELNET"; flow:to_client,established; content:"login: "; nocase; detection_filter:track by_dst,count 30,seconds 30; sid:8000046; rev:1;)
#Dan 05/23/2017
alert tcp any any -> any [23,2323,3323,4323] (msg:"ZB Mirai.Shell.IoT"; flow:to_server,established; content:"/bin/busybox "; depth:19; sid: 8000047; rev:1;)
#Dan 05/23/2017
alert tcp any any -> any 445 (msg:"ZB WannaCry.Dropper, extract=true fastpath=true "; flow:to_server,established; content:"|00 83 f3|h6agLCqPqVyXi2VSQ8O6Yb9ijBX54jY6KM+sz33NmS"; sid: 8000048; rev:1;)
#Dan 05/31/2017
alert tcp any any -> any 445 (msg:"ZB SambaCry.CVE-2017-7494, extract=true "; flow:to_server,established; content:"|FF|SMB|2d 00|"; offset:4; depth:6; content:"|00 00|"; distance:1; within:2; content:"|12 00|"; distance:40; within:2; content:"|2e|so|00|"; fast_pattern; distance:16; reference:url, AP-2424; sid:8000049; rev:1;)
alert tcp any any -> any 445 (msg:"ZB SambaCry2.CVE-2017-7494, extract=true "; flow:to_server,established; content:"|FF|SMB|a2 00|"; offset:4; depth:6; content:"|00 00|"; distance:1; within:2; content:"|2f|"; offset:95; content:"|2e|so|00|"; distance:0; within: 25; fast_pattern; reference:url, AP-2424; sid:8000050; rev:1;)
#Dan - 03/27/2017
alert tcp any any -> any [23,2323,3323,4323] (msg:"ZB TELNET.BusyBox"; flow:to_server,established; content:"/bin/busybox"; flowbits:set,ET.telnet.busybox;threshold: type limit, count 1, track by_src, seconds 30; reference:url,lists.emergingthreats.net/pipermail/emerging-sigs/2016-August/027524.html;  sid:8000051; rev:1;)

alert tcp any any -> any [23,2323,3323,4323] (msg:"ZB Telnet.BusyBox_Shell.IoT"; flow:to_server,established; content:"shell"; fast_pattern; pcre:"/\bshell\b/"; flowbits:isset,ET.telnet.busybox; flowbits:set,ET.telnet.busybox.shell;threshold: type limit, count 1, track by_src, seconds 30; reference:url,lists.emergingthreats.net/pipermail/emerging-sigs/2016-August/027524.html;  sid:8000052; rev:2;)

alert tcp any any -> any [23,2323,3323,4323] (msg:"ZB ECCHI.Telnet_Busybox.IoT"; flow:to_server,established; content:"ECCHI"; flowbits:isset,ET.telnet.busybox; threshold: type limit, count 1, track by_src, seconds 30; reference:url,lists.emergingthreats.net/pipermail/emerging-sigs/2016-August/027524.html; sid:8000053; rev:1;)

alert tcp any any -> any [23,2323,3323,4323] (msg:"ZB MEMES.TELNET_Busybox.IoT"; flow:to_server,established; content:"MEMES"; flowbits:isset,ET.telnet.busybox; threshold: type limit, count 1, track by_src, seconds 30; reference:url,lists.emergingthreats.net/pipermail/emerging-sigs/2016-August/027524.html; sid:8000054; rev:1;)

alert tcp any any -> any 6789 (msg:"ZB Dahua.Mirai_Login.IoT"; flow:to_server,established; content:"888888|0d 0a|888888"; depth:14; content:"busybox telnetd -p"; distance:0; reference:url,isc.sans.edu/diary/21833; sid:8000055; rev:1;)

#FLOWBITS:
alert tcp any any -> any any (msg:"ZB Moose.NATraversal "; flow:established,to_server; dsize:4; content:"|18 00 00 00|"; fast_pattern; flowbits:set,ET.Linux.Moose; flowbits:noalert; reference:url,welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf; sid:8000056; rev:1;)

alert tcp any any -> any any (msg:"ZB Moose.NAT_Traveral_Sleep.IoT"; flow:established,from_server; dsize:8; content:"|16 00|"; depth:2; content:!"|00 00|"; within:2; content:!"|00|"; distance:2; within:1; content:!"|00|"; distance:5; within:1; flowbits:isset,ET.Linux.Moose; reference:url,welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf; sid:8000057; rev:1;)
alert tcp any any -> any any (msg:"ZB Moose.NAT_Traversal_Tunnel.IoT"; flow:established,from_server; dsize:8; content:"|17 00|"; depth:2; content:!"|00 00|"; within:2; content:!"|00|"; distance:2; within:1; content:!"|00|"; distance:5; within:1; flowbits:isset,ET.Linux.Moose; reference:url,welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf; sid:8000058; rev:1;)

#Moose v2:
alert tcp any any -> any any (msg:"ZB Moose.CnCRequest_M1.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"PP|3b 20|nhash="; fast_pattern; content:"PHPSESSID="; content:"AAAAAAAAAAAAAAA"; distance:0; content:"PP|3b 20|nhash="; distance:0; content:"|3b 20|chash="; distance:0; content:!"|0d 0a|Referer|3a 20|"; sid:8000059; rev:1;)

alert tcp any any -> any any (msg:"ZB Moose.CnCResponse.IoT"; flow:from_server,established; content:"200"; content:"PP|3b 20|expires="; fast_pattern; content:"PHPSESSID="; content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"; distance:0; content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"; distance:0; content:"PP|3b 20|expires="; distance:0; content:"WL="; content:"PP|3b 20|expires="; distance:0; content:"Content-Type|3a 20|text/html"; file_data; content:"<html><body><h1>It works!</h1>"; nocase; depth:30; sid:8000060; rev:1;)

alert tcp any any -> any any (msg:"ZB Moose.CnCRequest_M2.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"PHPSESSID="; content:"|3b 20|nhash="; distance:0; content:"|3b 20|chash="; distance:0; pcre:"/^Host\x3a\x20[^\r\n]+\r\nUser-Agent\x3a\x20[^\r\n]+\r\nAccept\x3a\x20[^\r\n]+\r\nAccept-Language\x3a\x20[^\r\n]+\r\nAccept-Encoding\x3a\x20[^\r\n]+\r\nConnection\x3a\x20[^\r\n]+[\r\n]+$/Hmi"; content:!"|0d 0a|Referer|3a 20|"; sid:8000061; rev:1;)

#PnScan:
alert tcp any any -> any 9000 (msg:"ZB PNScan.2"; flow:established,to_server; content:"/check"; fast_pattern; flowbits:set,ET.PNScan.2; flowbits:noalert; reference:url,blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html; reference:url,vms.drweb.com/virus/?_is=1&i=7299536; sid:8000062; rev:2;)

alert tcp any 9000 -> any any (msg:"ZB PNScan.2.StatusCheckResponse.IoT "; flow:established,from_server; content:"Content-Length|3a 20|12|0d 0a|"; file_data; content:"{|22|status|22 3a|1}"; fast_pattern; flowbits:isset,ET.PNScan.2; reference:url,blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html; reference:url,vms.drweb.com/virus/?_is=1&i=7299536; sid:8000063; rev:2;)

alert tcp any any -> any 9000 (msg:"ZB PNScan.2.CnCBeacon.IoT "; flow:established,to_server; content:"POST "; depth:5; content:"?ver="; distance:0; fast_pattern; pcre:"/^\/(?:i686|arm|mips(?:el)?)\?ver=\d+$/U"; content:!"|0d 0a|Referer|3a|"; reference:url,blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html; reference:url,vms.drweb.com/virus/?_is=1&i=7299536; sid:8000064; rev:3;)

alert tcp any any -> any 9000 (msg:"ZB PNScan.2.CnCBeacon.IoT "; flow:established,to_server; content:"POST "; depth:5; content:"/srv_report?ver="; distance:0; fast_pattern; pcre:"/\?ver=\d+$/U"; content:!"|0d 0a|Referer|3a|"; reference:url,blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html; reference:url,vms.drweb.com/virus/?_is=1&i=7299536; sid:8000065; rev:2;)

#Dan 04/18/17
alert tcp any any -> any any (msg:"ZB ETERNALROMANCE.Exploit"; flow:from_server,established; content:"|FF|SMB|25 05 00 00 80|"; offset:4; depth:9; content:"LSbfLScnLSepLSlfLSmf"; distance:0; fast_pattern; content:"LSrfLSsrLSscLSblLSss"; within:20; content:"LSshLStrLStcLSopLScd"; within:20; flowbits:set,ETPRO.ETERNALROMANCE; sid:8000066; rev:1;)
alert tcp any any -> any any (msg:"ZB ETERNALROMANCE.MalwareTransfer "; flow:to_server,established; flowbits:isset,ETPRO.ETERNALROMANCE; content:"|FF|SMB|26 00 00 00 00|"; offset:4; depth:9; content:"|4d 5a|"; distance:0; content:"This program cannot be run"; nocase; distance:0; fast_pattern:6,20; sid:8000067; rev:2;)
alert tcp any any -> any any (msg:"ZB ERNALCHAMPION.SyncRequest"; flow:to_server,established; content:"|ff|SMB|25 00 00 00 00 18 03 c0 00 00 00 00 00 00 00 00 00 00 00 00|"; offset:4; depth:24; content:"|00 00 00 00 ff ff ff ff 00 00|"; distance:17; within:10; content:"|5c 00 50 00 49 00 50 00 45 00 5c 00 4c 00 41 00 4e 00 4d 00 41 00 4e 00 00 00|"; distance:13; within:26; content:"|82 00|zb12g12DWrLehig24"; within:19; fast_pattern; flowbits:set,ET.ETERNALCHAMPIONsync; flowbits:noalert; sid:8000068; rev:1;)

alert tcp any any -> any any (msg:"ZB ETERNALCHAMPION.SyncResponse"; flow:from_server,established; flowbits:isset,ET.ETERNALCHAMPIONsync; content:"|ff|SMB|25 00 00 00 00 98 03 c0 00 00 00 00 00 00 00 00 00 00 00 00|"; offset:4; depth:24; fast_pattern:4,20; content:"|7c 00|"; distance:32; within:2; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:20; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:100; within:20; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:100; within:20; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:100; within:20; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; isdataat:!1,relative; sid:8000069; rev:1;)

alert tcp any any -> any any (msg:"ZB DOUBLEPULSAR.BeaconResponse"; flow:from_server,established; content:"|00 00 00 23 ff|SMB2|02 00 00 c0 98 07 c0 00 00|"; depth:18; content:"|00 00 00 08 ff fe 00 08|"; distance:8; within:8; fast_pattern; pcre:"/^[\x50-\x59]/R"; content:"|00 00 00|"; distance:1; within:3; isdataat:!1,relative; sid:8000070; rev:1;)

alert tcp any [139,445] -> any any (msg:"ZB SAMBA.BufferOverflow"; flow:to_client,established; content:"|FE|SMB|40 00|"; depth:6; offset:4; content:"|03 00|"; within:2; distance:6; content:"|01|"; within:1; distance:2; content:"|10 00|"; within:2; distance:47; byte_test:3, >, 1481, 1; reference:cve,2017-0016; sid:8000071; rev:4;)

#Dan 06/11/2017
alert tcp any any -> any any (msg:"ZB ECLIPSEDWING.RPCExploit"; flow:to_server,established;  content:"|ff|SMB|2f 00 00 00 00|"; offset:4; depth:9; content:"NTLMSSP|00 03 00 00 00 01 00 01 00|"; distance:0; fast_pattern; content:"|00 00 00 00 49 00 00 00|"; distance:4; within:8; content:"|00 00 00 00 48 00 00 00|"; within:8; content:"|00 00 00 00 48 00 00 00|"; within:8; content:"|00 00 00 00 48 00 00 00|"; within:8; content:"|00 00 00 00 49 00 00 00|"; within:8; content:"|00 00 00 00 00 00 00 00 00|"; distance:4; within:9; isdataat:!1,relative; sid:8000072; reference:url,MS08-067; reference:url,AP-1994; rev:1;)

alert tcp any any -> any any (msg:"ZB ECLIPSEDWING.RPCExploit"; flow:to_server,established; content:"|ff|SMB|2f 00 00 00 00|"; offset:4; depth:9; content:"|00 00 00 00 ff ff ff ff 08 00|"; distance:30; within:10; content:"|2e 00 00 00 00 00 00 00 2e 00 00 00|"; distance:0; content:"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|"; within:12; fast_pattern; content:"|2e 00 00 00 00 00 00 00 2e 00 00 00|"; distance:0; content:"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|"; within:12; content:"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|"; distance:0; content:"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|"; distance:0; isdataat:800,relative; sid:8000073; reference:url,MS08-067;  reference:url,AP-1994; rev:1;)

alert tcp any any -> any 445 (msg: "ZB Conficker.A.Shellcode, fastpath=true"; content: "|e8 ff ff ff ff c1|^|8d|N|10 80|1|c4|Af|81|9EPu|f5 ae c6 9d a0|O|85 ea|O|84 c8|O|84 d8|O|c4|O|9c cc|IrX|c4 c4 c4|,|ed c4 c4 c4 94|&<O8|92|\;|d3|WG|02 c3|,|dc c4 c4 c4 f7 16 96 96|O|08 a2 03 c5 bc ea 95|\;|b3 c0 96 96 95 92 96|\;|f3|\;|24|i| 95 92|QO|8f f8|O|88 cf bc c7 0f f7|2I|d0|w|c7 95 e4|O|d6 c7 17 f7 04 05 04 c3 f6 c6 86|D|fe c4 b1|1|ff 01 b0 c2 82 ff b5 dc b6 1b|O|95 e0 c7 17 cb|s|d0 b6|O|85 d8 c7 07|O|c0|T|c7 07 9a 9d 07 a4|fN|b2 e2|Dh|0c b1 b6 a8 a9 ab aa c4|]|e7 99 1d ac b0 b0 b4 fe eb eb|"; sid: 8000074; rev: 1;)
alert tcp any any -> any 445 (msg: "ZB Conficker.B.Shellcode, fastpath=true"; content: "|e8 ff ff ff ff c2|_|8d|O|10 80|1|c4|Af|81|9MSu|f5|8|ae c6 9d a0|O|85 ea|O|84 c8|O|84 d8|O|c4|O|9c cc|Ise|c4 c4 c4|,|ed c4 c4 c4 94|&<O8|92|\;|d3|WG|02 c3|,|dc c4 c4 c4 f7 16 96 96|O|08 a2 03 c5 bc ea 95|\;|b3 c0 96 96 95 92 96|\;|f3|\;|24 |i|95 92|QO|8f f8|O|88 cf bc c7 0f f7|2I|d0|w|c7 95 e4|O|d6 c7 17 cb c4 04 cb|{|04 05 04 c3 f6 c6 86|D|fe c4 b1|1|ff 01 b0 c2 82 ff b5 dc b6 1f|O|95 e0 c7 17 cb|s|d0 b6|O|85 d8 c7 07|O|c0|T|c7 07 9a 9d 07 a4|fN|b2 e2|Dh|0c b1 b6 a8 a9 ab aa c4|]|e7 99 1d ac b0 b0 b4 fe eb eb|"; sid: 8000075; rev: 1;)

#Dan Jun 15 2017 - LATENBOT
alert tcp any any -> any any (msg:"ZB LATENBOT.RemoteAccess, extract=true"; flow:established,to_server; content:"POST "; depth:5; content:"/$rdgate?ACTION=HELLO HTTP/1."; fast_pattern; content:!"|0d 0a|Accept: "; content:!"|0d 0a|User-Agent: "; reference:url,AP-2546; sid:8000076; rev:1;)

#Jianhong Jun 19 2017 - HiddenCobra
alert tcp any any -> any any (msg:"ZB HiddenCobra.DDos_Handshake"; flow:to_server,established; content:"|1B 17 E9 E9 E9 E9|"; depth:6; reference:url,www.us-cert.gov/ncas/alerts/TA17-164A; reference:url,AP-2564; sid:8000077; rev:1;)
alert tcp any any -> any any (msg:"ZB HiddenCobra.C2_Beacon"; flow:to_server,established; content:"|18 17 E9 E9 E9 E9|"; fast_pattern:only; isdataat:!7; reference:url,www.us-cert.gov/ncas/alerts/TA17-164A; reference:url,AP-2564; sid:8000078; rev:1;)

alert tcp any any -> any 445 (msg:"ZB SMBv1.TypeConfusion.CVE-2017-0143 "; flow:to_server,established; content:"|FF|SMB|2F 00 00 00 00|"; depth:9; offset:4; fast_pattern; byte_test:1,!&,0x80,0,relative; content:"|00 00 00 00 00 00 00 00 00 00|"; within:10; distance:5; byte_extract:2,6,mid,relative,little; content:"|FF 00|"; within:2; distance:1; byte_test:2,=,mid,2,relative,little; content:"|04 00|"; within:2; distance:12; byte_test:2,>,65000,0,relative,little; byte_test:2,>,500,4,relative,little; reference:url,AP-2568; sid:8000079; rev:1;)

#alert tcp any 445 -> any any (msg:"ZB SMB_MS17-010_KernelHeap_Leak "; flow:to_client,established; content:"|FF 53 4d 42 25|"; content:"Frag"; distance:0; fast_pattern; content:"Free";  distance:0; content:"|FA FF FF|"; content:"|F8 FF FF|"; within:3; distance:5; content:"|F8 FF FF|"; within:3; distance:5; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010;  reference:url,AP-2568; sid:8000081; rev:1;)

alert tcp any any -> any 445 (msg:"ZB SMB.NT_TRANSACT_RENAME_Leak"; flow:to_server,established; content:"|FF|SMB|A0 00 00 00 00|"; depth:9; offset:4; content:"|05 00|"; within:2; distance:60; byte_test:2,>,1024,0,relative,little; reference:url,msdn.microsoft.com/en-us/library/ee441910.aspx;  reference:url,AP-2568; sid:8000082; rev:1;)

alert tcp any any -> any 445 (msg:"ZB ETERNALBLUE_MS17-010_SMB_RemoteExecution"; flow:to_server,established; content:"|FF|SMB|A0 00 00 00 00|"; depth:9; offset:4; content:"|01 00 00 00 00|"; within:5; distance:59; byte_test:4,>,0x8150,-33,relative,little; reference:url,isc.sans.edu/forums/diary/ETERNALBLUE+Possible+Window+SMB+Buffer+Overflow+0Day/22304/; reference:url,AP-2568; sid:8000083; rev:1;)


#alert tcp any any -> any 445 (msg:"ZB SMB.Negotiate_ProcessID.CVE-2009-3103 "; flow:to_server,established; content:"|FF 53 4d 42 72|"; offset:4; depth:5; content:!"|00 00|"; distance:7; within:2; reference:url,www.exploit-db.com/exploits/14674/; reference:url,AP-2630; sid:8000084; rev:1;)

alert tcp any any -> any 445 (msg:"ZB ETERNALBLUE_MS17-010_SMB_RemoteExecution_v2, extract=true, fastpath=true"; flow:established,to_server; content:"|8000a80000000000000000000000000000000000ffff000000000000ffff0000000000000000000000000000000000000000000000f1dfff000000000000000020f0dfff00f1dfffffffffff600004100000000080efdfff|"; reference:url,AP-2630; sid:8000085; rev:1;)

alert tcp any any -> any any (msg:"ZB ETERNALBLUE_MS17-010_SMB_RemoteExecution_v3, extract=true, fastpath=true"; flow:to_server,established; content:"|ff|SMB|32 00 00 00 00 18 07 c0|"; offset:4; depth:12; content:"|00 00 00 00 00 00 00 00 00 00 00 08 ff fe 00 08|"; distance:2; within:16; fast_pattern; content:"|0f 0c 00 00 10 01 00 00 00 00 00 00 00 f2 00 00 00 00 00 0c 00 42 00 00 10 4e 00 01 00 0e 00 0d 10 00|"; distance:2; within:34; isdataat:1000,relative; threshold: type both, track by_src, count 10, seconds 1; reference:url,AP-2630; sid:8000086; rev:1;)

alert tcp any any -> any 80 (msg:"ZB NotPetya.Ransomware "; flow:established,to_server; content:"POST "; depth:5; content:"/wish.php HTTP/1.0|0d 0a|User-Agent: Mozilla/4.08 (Charon\; Inferno)|0d 0a|"; fast_pattern; reference:url,AP-2630; sid:8000087; rev:1;)

#alert tcp any any -> any 445 (msg: "ZB NotPetya.Ransomware_PERFC "; flow: to_server, established, no_stream; content: "|fe 53 4d 42|"; offset: 4; depth: 4; content: "|05 00|"; offset: 16; depth: 2; byte_jump: 2, 112, little, from_beginning, post_offset 4; content: "|70 00 65 00 72 00 66 00 63 00 2e 00 64 00 61 00 74 00|"; distance:0; reference:url,AP-2630; sid: 8000088; rev: 1;)

#alert tcp any any -> any 445 (msg:"ZB SMB2.Create.PSEXESVC "; flow:to_server, established, no_stream; content: "|fe 53 4d 42|"; offset: 4; depth: 4; content: "|05 00|"; offset: 16; depth: 2; byte_jump: 2, 112, little, from_beginning, post_offset 4; content:"|50 00 53 00 45 00 58 00 45 00 53 00 56 00 43 00 2e 00 45 00 58 00 45|"; distance:0; reference:url,AP-2630; sid: 8000089; rev:1;)

#Jianhong Jun 30 2017 - WMIC 

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_OS "; flow:established,to_server; content:"Boot Device"; fast_pattern; content:"Build Number"; content:"Build Type"; sid:8000090; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_COMPUTERSYSTEM "; flow:established,to_server; content:"AdminPasswordStatus"; fast_pattern; content:"AutomaticManagedPagefile"; content:"Build Type"; reference:url,AP-2630; sid:8000091; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_NETLOGIN "; flow:established,to_server; content:"AccountExpires"; fast_pattern; content:"AuthorizationFlags"; content:"BadPasswordCount"; reference:url,AP-2630; sid:8000092; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_NIC "; flow:established,to_server; content:"AdapterType"; fast_pattern; content:"AdapterTypeId"; content:"AutoSense"; reference:url,AP-2630; sid:8000093; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_PROCESS "; flow:established,to_server; content:"CSCreationClassName"; fast_pattern; content:"CSName"; content:"Description"; content:"ExecutablePath"; reference:url,AP-2630; sid:8000094; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_SERVER "; flow:established,to_server; content:"BlockingRequestsRejected"; fast_pattern; content:"BytesReceivedPersec"; content:"BytesTotalPersec"; content:"ExecutablePath"; reference:url,AP-2630; sid:8000095; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_SERVICE "; flow:established,to_server; content:"AcceptPause"; fast_pattern:only; content:"AcceptStop"; content:"Caption"; content:"ExecutablePath"; reference:url,AP-2630; sid:8000096; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_SHARE "; flow:established,to_server; content:"AccessMask"; fast_pattern; content:"AllowMaximum"; content:"Caption"; content:"Description"; reference:url,AP-2630; sid:8000097; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_SYSACCOUNT "; flow:established,to_server; content:"Caption"; content:"Description"; content:"Domain"; content:"InstallDate"; content:"LocalAccount"; fast_pattern; reference:url,AP-2630; sid:8000098; rev:1;)

#alert tcp any any -> any any (msg:"ZB NotPetya.Ransomeware.WMIC_STARTUP "; flow:established,to_server; content:"Caption"; content:"Command"; content:"Description"; content:"Location"; content:"UserSID"; fast_pattern; reference:url,AP-2630; sid:8000099; rev:1;)

alert tcp any any -> any 80 (msg:"ZB Hikvision.PrivilegeEscalation.CVE-2013-4975.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/PSIA/System/ConfigurationData HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|Authorization"; distance:0; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,AP-2596; sid:8000100; rev:1; )

#Jianhong July 24 2017 - Devil's Ivy Buffer Overflow
#alert tcp any any -> any any (msg:"ZB DevilIvy.BufferOverflow.RemoteAccess.IoT"; flow:established,to_server; content:"POST "; depth:5; content:!"ConnType=LongLived"; within:1024; pcre:"/\x0d\x0aContent-Length: [2-9]\d{9,}\x0d\x0a/"; reference:cve,2017-9765; reference:url,AP-2897; sid:8000103; rev:1;)

#Dan Aug 7, 2017
#alert tcp any any -> any [80,443] (msg:"ZB IIS.IntegerOverflow.CVE-2015-1635"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1.1|0d 0a|"; distance:0; content:"|0d 0a|Range: bytes="; distance:0; content:"-18446744073709551615"; distance:0; fast_pattern; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,AP-3138;  reference:url,https://ics-cert.us-cert.gov/advisories/ICSMA-17-215-02; sid:8000104; rev:1; )
alert tcp any any -> any 3465 (msg:"ZB HP.PSCA.Linux.CommandInjection.CVE-2015-1497 "; content:"hide hide|09|"; within:40; fast_pattern; content:"sh -c "; distance:0; reference:url,AP-3138; reference:url,https://nvd.nist.gov/vuln/detail/CVE-2015-1497; sid:8000105; rev:1;)
alert tcp any any -> any 3465 (msg:"ZB HP.PSCA.Win.CommandInjection.CVE-2015-1497 "; content:"hide hide|09|"; within:40; fast_pattern; content:"cmd.exe /c "; distance:0; reference:url,AP-3138; reference:url,https://nvd.nist.gov/vuln/detail/CVE-2015-1497; sid:8000106; rev:1;)

#Dan Aug 9, 2017
alert tcp any any -> any any (msg:"ZB Mirai.EirD1000.RCE.IoT "; flow:established,to_server; content:"POST "; depth:5; content:"/UD/act?1 HTTP/1.1"; distance:0; fast_pattern; content:"<NewNTPServer1>`"; distance:0; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759/; reference:url,AP-2051; sid:8000107; rev:1;)
alert tcp any any -> any any (msg:"ZB Mirai.Generic.RCE.IoT "; flow:established,to_server; content:"POST "; depth:5; content:"HTTP/1."; distance:0; content:"wget http"; distance:0; content:"chmod "; distance:0; fast_pattern; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759/; reference:url,AP-2051; sid:8000108; rev:1;)
alert tcp any any -> any any (msg:"ZB Mirai.Generic.RCE.IoT "; flow:established,to_server; content:"GET "; depth:4; content:"HTTP/1."; distance:0; content:"wget http"; distance:0; content:"chmod "; distance:0; fast_pattern; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759/; reference:url,AP-2051; sid:8000109; rev:1;)

#Dan Aug 16, 2017
#alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"ZB ELF64_binary.HTTP_Download.Suspicious"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; content:"|0d 0a 0d 0a 7f 45 4c 46 02|"; distance:0; within:360; sid:8000110; rev:1; )
#alert tcp any any -> any any (msg:"ZB ELF64_Binary.Download.Suspicious"; flow:to_client,established; content:"|7f 45 4c 46 02|"; depth:5; sid:8000111; rev:1;)

#Dan Aug 18, 2017
alert tcp any any -> any any (msg:"ZB Diablo6.Ransomware.Callback"; flow:to_server,established; content:"GET "; depth:4; content:"/y872ff2f HTTP/1."; fast_pattern; distance:0; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,AP-3343; sid:8000112; rev:1; )
alert tcp any any -> any any (msg:"ZB Diablo6.Ransomware.Callback"; flow:to_server,established; content:"GET "; depth:4; content:"/JbhbUsfs HTTP/1."; fast_pattern; distance:0; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,AP-3343; sid:8000113; rev:1; )
alert tcp any any -> any any (msg:"ZB Diablo6.Ransomware.Callback"; flow:to_server,established; content:"GET "; depth:4; content:"/jbYUF6D??"; fast_pattern; content:" HTTP/1.";  distance:0; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,AP-3343; sid:8000114; rev:1; )

#Dan Aug 23, 2017
alert tcp any 443 -> any any (msg:"ZB SyncCrypt.Ransomware.Certificate"; flow:to_client,established; content:"|6e fc 90 10 eb 82 43 2e c6 b8 36 fb 5b 76 66 c8|"; within:170; fast_pattern; content:!"GET "; depth:4; content:!"POST "; depth:5; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,AP-3343; sid:8000115; rev:1; )

#Dan Aug 24, 2017
alert tcp any 80 -> any any (msg:"ZB PowerShell.Downloader"; flow:to_client,established; content:"WScript.shell"; nocase; fast_pattern; content:"powershell.exe "; nocase; distance:0; content:".DownloadFile("; nocase; distance:0;  content:!"GET "; depth:4; content:!"POST "; depth:5; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,AP-3343; sid:8000116; rev:1; )
#Dan Aug 28, 2017
alert tcp any any -> any 80 (msg:"ZB Defray.Ransomware.Callback"; flow:to_server,established; content:"POST "; depth:5; content:"|0d 0a 0d 0a|e="; distance:0; fast_pattern; content:"&s="; distance:0;  content:"&f="; distance:0; content:"&t="; distance:0; content:"&h="; distance:0; content:"&w="; distance:0; content:"&r="; distance:0; reference:url,AP-3484; sid:8000117; rev:1;)

alert tcp any any -> any any (msg:"ZB Metasploit_cmd/unix/reverse, extract=true"; flow:established; content:"| 73 68 20 2d 63 20 27 28 73 6c 65 65 70 20 |"; content:"| 7c 74 65 6c 6e 65 74 20 |"; content:"| 7c 77 68 69 6c 65 20 3a 20 3b 20 64 6f 20 73 68 20 26 26 20 62 72 65 61 6b 3b 20 64 6f 6e 65 20 32 3e 26 31 7c 74 65 6c 6e 65 74 20 |"; content:"| 20 3e 2f 64 65 76 2f 6e 75 6c 6c 20 32 3e 26 31 20 26 29 27 |"; sid:8000118; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_cmd/unix/reverse_bash, extract=true"; flow:established; content:"| 2d 3b 65 78 65 63 20 |"; content:"| 3c 3e 2f 64 65 76 2f 74 63 70 2f |"; content:"| 3b 73 68 20 3c 26 |"; content:"| 20 32 3e 26 |"; sid:8000119; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_cmd/unix/reverse_netcat, extract=true"; flow:established; content:" nc "; content:"| 20 2d 65 20 2f 62 69 6e 2f 73 68 20 |"; distance:0; sid:8000120; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/armle/shell_reverse_tcp, extract=true"; flow:established; content:"| 02 00 a0 e3 01 10 a0 e3 05 20 81 e2 8c 70 a0 e3 8d 70 87 e2 00 00 00 ef 00 60 a0 e1 84 10 8f e2 10 20 a0 e3 8d 70 a0 e3 8e 70 87 e2 00 00 00 ef 06 00 a0 e1 00 10 a0 e3 3f 70 a0 e3 00 00 00 ef 06 00 a0 e1 01 10 a0 e3 3f 70 a0 e3 00 00 00 ef 06 00 a0 e1 02 10 a0 e3 3f 70 a0 e3 00 00 00 ef 48 00 8f e2 04 40 24 e0 10 00 2d e9 0d 20 a0 e1 04 00 2d e9 0d 20 a0 e1 10 00 2d e9 48 10 9f e5 02 00 2d e9 00 20 2d e9 0d 10 a0 e1 04 00 2d e9 0d 20 a0 e1 0b 70 a0 e3 00 00 00 ef 00 00 a0 e3 01 70 a0 e3 00 00 00 ef 02 00 00 |"; content:"| 2f 73 79 73 74 65 6d 2f 62 69 6e 2f 73 68 00 00 2d 43 00 00 |"; sid:8000121; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/mipsbe/shell_reverse_tcp, extract=true"; flow:established; content:"| 24 09 ff ef 05 10 ff ff 28 08 82 82 01 20 48 27 01 3f c8 21 af b9 85 48 23 b9 85 48 3c 1c 00 00 27 9c 00 00 03 99 e0 21 27 bd ff d0 af bc 00 00 af bc 00 28 8f 84 00 00 00 00 00 00 24 84 00 f8 00 00 00 00 8c 85 00 00 8c 87 00 04 3c 08 c0 a8 35 06 01 09 27 b9 00 18 24 03 00 02 24 02 00 |"; content:"| af a5 00 18 af a6 00 0c af a7 00 1c a7 a3 00 08 a7 a2 00 0a af b9 00 20 af a0 00 24 24 04 00 02 24 05 00 02 00 00 30 21 24 02 10 57 00 00 00 0c 24 04 ff ff 10 44 00 1a 00 40 18 21 00 60 20 21 24 06 00 10 27 a5 00 08 24 02 10 4a 00 00 00 0c 14 40 00 0e 00 00 28 21 24 02 0f df 00 00 00 0c 24 05 00 01 24 02 0f df 00 00 00 0c 24 05 00 02 24 02 0f df 00 00 00 0c 03 20 20 21 27 a5 00 20 00 00 30 21 24 02 0f ab 00 00 00 0c 00 00 20 21 24 02 0f a1 00 00 00 0c 03 e0 00 08 27 bd 00 30 24 04 00 01 24 02 0f a1 00 00 00 0c 10 00 ff e4 00 60 20 21 2f 62 69 6e 2f 73 68 00 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 |"; content:"| 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 |"; content:"| 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 |"; sid:8000122; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/mipsle/shell_reverse_tcp, extract=true"; flow:established; content:"| ef ff 09 24 ff ff 10 05 82 82 08 28 27 48 20 01 21 c8 3f 01 48 85 b9 af 48 85 b9 23 00 00 1c 3c 00 00 9c 27 21 e0 99 03 00 00 89 8f d8 ff bd 27 e8 00 2a 25 04 00 47 8d e8 00 28 8d 01 09 04 3c c0 a8 83 34 18 00 b9 27 02 00 06 24 00 |"; content:"| 05 24 08 00 a6 a7 0a 00 a5 a7 18 00 a8 af 1c 00 a7 af 0c 00 a3 af 20 00 b9 af 24 00 a0 af 02 00 04 24 02 00 05 24 21 30 00 00 57 10 02 24 0c 00 00 00 21 18 40 00 ff ff 02 24 1a 00 62 10 01 00 04 24 21 20 60 00 08 00 a5 27 10 00 06 24 4a 10 02 24 0c 00 00 00 0e 00 40 14 21 28 00 00 df 0f 02 24 0c 00 00 00 01 00 05 24 df 0f 02 24 0c 00 00 00 02 00 05 24 df 0f 02 24 0c 00 00 00 21 30 00 00 21 20 20 03 20 00 a5 27 ab 0f 02 24 0c 00 00 00 21 20 00 00 a1 0f 02 24 0c 00 00 00 08 00 e0 03 28 00 bd 27 a1 0f 02 24 0c 00 00 00 e5 ff 00 10 21 20 60 00 2f 62 69 6e 2f 73 68 00 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 |"; content:"| 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 |"; content:"| 30 30 30 30 30 30 30 30 30 30 30 30 |"; sid:8000123; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/ppc/shell_reverse_tcp, extract=true"; flow:established; content:"| 7f ff fa 78 3b a0 01 ff 3b 9d fe 02 3b 7d fe 03 97 e1 ff fc 97 81 ff fc 97 61 ff fc 7c 24 0b 78 38 7d fe 02 38 1d fe 67 44 ff ff 02 7c 7a 1b 78 3b 3d fe 11 3e e0 |"; content:"| 96 e1 ff fc 96 c1 ff fc 93 61 ff fe 7c 35 0b 78 97 21 ff fc 96 a1 ff fc 97 41 ff fc 7c 24 0b 78 38 7d fe 04 38 1d fe 67 44 ff ff 02 7f 64 db 78 7f 43 d3 78 38 1d fe 40 44 ff ff 02 37 7b ff ff 40 80 ff ec 7c a5 2a 79 40 82 ff fd 7f c8 02 a6 3b de 01 ff 38 7e fe 25 98 be fe 2c 94 a1 ff fc 94 61 ff fc 7c 24 0b 78 38 1d fe 0c 44 ff ff 02 2f 62 69 6e 2f 73 68 |"; sid:8000124; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/ppc64/shell_reverse_tcp, extract=true"; flow:established; content:"| 7f ff fa 78 3b a0 01 ff 3b 9d fe 02 3b 7d fe 03 fb e1 ff f9 fb 81 ff f9 fb 61 ff f9 7c 24 0b 78 38 7d fe 02 38 1d fe 67 44 ff ff 02 7c 7a 1b 78 3b 3d fe 11 3e e0 |"; content:"| 96 e1 ff fc 96 c1 ff fc 93 61 ff fe 7c 35 0b 78 fb 21 ff f9 fa a1 ff f9 fb 41 ff f9 7c 24 0b 78 38 7d fe 04 38 1d fe 67 44 ff ff 02 7f 64 db 78 7f 43 d3 78 38 1d fe 40 44 ff ff 02 37 7b ff ff 40 80 ff ec 7c a5 2a 79 40 82 ff fd 7f c8 02 a6 3b de 01 ff 38 7e fe 25 98 be fe 2c f8 a1 ff f9 f8 61 ff f9 7c 24 0b 78 38 1d fe 0c 44 ff ff 02 2f 62 69 6e 2f 73 68 |"; sid:8000125; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/x64/shell/reverse_tcp, extract=true"; flow:established; content:"| 48 31 ff 6a 09 58 99 b6 10 48 89 d6 4d 31 c9 6a 22 41 5a b2 07 0f 05 56 50 6a 29 58 99 6a 02 5f 6a 01 5e 0f 05 48 97 48 b9 02 00 00 |"; content:"| 51 48 89 e6 6a 10 5a 6a 2a 58 0f 05 59 5e 5a 0f 05 ff e6 |"; sid:8000126; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/x64/shell_reverse_tcp, extract=true"; flow:established; content:"| 6a 29 58 99 6a 02 5f 6a 01 5e 0f 05 48 97 48 b9 02 00 00 |"; content:"| 51 48 89 e6 6a 10 5a 6a 2a 58 0f 05 6a 03 5e 48 ff ce 6a 21 58 0f 05 75 f6 6a 3b 58 99 48 bb 2f 62 69 6e 2f 73 68 00 53 48 89 e7 52 57 48 89 e6 0f 05 |"; sid:8000127; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/x86/meterpreter/reverse_ipv6_tcp, extract=true"; flow:established; content:"| 31 db 53 43 53 6a 0a 89 e1 6a 66 58 cd 80 96 99 68 00 00 00 00 68 |"; content:"| 68 00 00 5e fe 68 00 00 00 00 68 fe 80 00 00 52 66 68 00 |"; content:"| 66 68 0a 00 89 e1 6a 1c 51 56 89 e1 43 43 6a 66 58 cd 80 89 f3 b6 0c b0 03 cd 80 89 df ff e1 |"; sid:8000128; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/x86/meterpreter/reverse_tcp, extract=true"; flow:established; content:"| 31 db 53 43 53 6a 02 6a 66 58 89 e1 cd 80 97 5b 68 |"; content:"| 66 53 89 e1 6a 66 58 50 51 57 89 e1 43 cd 80 5b 99 b6 0c b0 03 cd 80 ff e1 |"; sid:8000129; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/x86/shell/reverse_ipv6_tcp, extract=true"; flow:established; content:"| 31 db 53 43 53 6a 0a 89 e1 6a 66 58 cd 80 96 99 68 00 00 00 00 68 |"; content:"| 68 00 00 5e fe 68 00 00 00 00 68 fe 80 00 00 52 66 68 00 |"; content:"| 66 68 0a 00 89 e1 6a 1c 51 56 89 e1 43 43 6a 66 58 cd 80 89 f3 b6 0c b0 03 cd 80 89 df ff e1 |"; sid:8000130; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/x86/shell/reverse_tcp, extract=true"; flow:established; content:"| 31 db 53 43 53 6a 02 6a 66 58 89 e1 cd 80 97 5b 68 |"; content:"| 66 53 89 e1 6a 66 58 50 51 57 89 e1 43 cd 80 5b 99 b6 0c b0 03 cd 80 ff e1 |"; sid:8000131; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/x86/shell_reverse_tcp, extract=true"; flow:established; content:"| 31 db f7 e3 53 43 53 6a 02 89 e1 b0 66 cd 80 5b 5e 68 |"; content:"| 66 53 6a 10 51 50 89 e1 43 6a 66 58 cd 80 59 87 d9 b0 3f cd 80 49 79 f9 50 68 2f 2f 73 68 68 2f 62 69 6e 89 e3 50 53 89 e1 b0 0b cd 80 |"; sid:8000132; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_linux/x86/shell_reverse_tcp2, extract=true"; flow:established; content:"| 31 db 53 43 53 6a 02 6a 66 58 89 e1 cd 80 93 59 b0 3f cd 80 49 79 f9 5b 5a 68 |"; content:"| 43 66 53 89 e1 b0 66 50 51 53 89 e1 43 cd 80 52 68 2f 2f 73 68 68 2f 62 69 6e 89 e3 52 53 89 e1 b0 0b cd 80 |"; sid:8000133; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/dllinject/reverse_http, extract=true"; flow:established; content:"| fc e8 ac 00 00 00 53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 49 6e 74 65 72 6e 65 74 20 53 65 74 74 69 6e 67 73 5c 5a 6f 6e 65 73 5c 33 00 31 30 30 34 31 32 30 30 31 32 30 31 31 30 30 31 43 3a 5c 70 72 6f 67 72 61 7e 31 5c 69 6e 74 65 72 6e 7e 31 5c 69 65 78 70 6c 6f 72 65 20 2d 6e 65 77 20 68 74 74 70 3a 2f 2f |"; content:"| 3a 38 30 30 30 2f |"; content:"| 00 e8 4e 00 00 00 60 8b 6c 24 24 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb e3 32 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 28 75 e3 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 8b 04 8b 01 e8 89 44 24 1c 61 c2 08 00 5f 5b 31 d2 64 8b 42 30 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 83 c0 7c 8b 40 3c 89 e5 68 7e d8 e2 73 50 68 72 fe b3 16 50 68 8e 4e 0e ec 50 ff d7 96 ff d7 89 45 00 ff d7 89 45 04 52 68 70 69 33 32 |"; content:"| 68 61 64 76 61 54 ff d6 68 a9 2b 92 02 50 68 dd 9a 1c 2d 50 ff d7 89 45 08 ff d7 97 87 f3 54 56 68 01 00 00 |"; content:"| ff d7 5b 83 c6 44 50 89 e7 80 3e 43 74 1b 50 ad 50 89 e0 6a 04 57 6a 04 6a 00 50 53 ff 55 08 eb e8 8a 0d 30 00 fe 7f 88 0e 6a 54 59 29 cc 89 e7 57 f3 aa 5f c6 07 44 fe 47 2c fe 47 2d 68 75 6c 74 00 68 44 65 66 61 68 74 61 30 5c 68 57 69 6e 53 89 67 08 8d 5f 44 53 57 50 50 6a 10 50 50 50 56 50 ff 55 00 ff 55 04 |"; sid:8000137; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/dllinject/reverse_ipv6_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 04 02 00 00 29 c4 48 48 54 50 68 29 80 6b 00 ff d5 50 50 50 6a 06 40 50 6a 17 68 ea 0f df e0 ff d5 89 c7 6a 1c e8 1c 00 00 00 17 00 00 |"; content:"| 00 00 00 00 fe 80 00 00 00 00 00 00 00 00 5e fe |"; content:"| 00 00 00 00 57 68 99 a5 74 61 ff d5 89 e6 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000138; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/dllinject/reverse_nonx_tcp, extract=true"; flow:established; content:"| fc 6a eb 47 e8 f9 ff ff ff 60 31 db 8b 7d 3c 8b 7c 3d 78 01 ef 8b 57 20 01 ea 8b 34 9a 01 ee 31 c0 99 ac c1 ca 0d 01 c2 84 c0 75 f6 43 66 39 ca 75 e3 4b 8b 4f 24 01 e9 66 8b 1c 59 8b 4f 1c 01 e9 03 2c 99 89 6c 24 1c 61 ff e0 31 db 64 8b 43 30 8b 40 0c 8b 70 1c ad 8b 68 08 5e 66 53 66 68 33 32 68 77 73 32 5f 54 66 b9 72 60 ff d6 95 53 53 53 53 43 53 43 53 89 e7 66 81 ef 08 02 57 53 66 b9 e7 df ff d6 66 b9 a8 6f ff d6 97 68 |"; content:"| 66 53 89 e3 6a 10 53 57 66 b9 57 05 ff d6 50 b4 0c 50 53 57 53 66 b9 c0 38 ff e6 |"; sid:8000139; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/dllinject/reverse_ord_tcp, extract=true"; flow:established; content:"| fc 31 db 64 8b 43 30 8b 40 0c 8b 50 1c 8b 12 8b 72 20 ad ad 4e 03 06 3d 32 33 5f 32 75 ef 8b 6a 08 8b 45 3c 8b 4c 05 78 8b 4c 0d 1c 01 e9 8b 41 58 01 e8 8b 71 3c 01 ee 03 69 0c 53 6a 01 6a 02 ff d0 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e1 53 b7 0c 53 51 57 51 6a 10 51 57 56 ff e5 |"; sid:8000140; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/dllinject/reverse_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 6a 05 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 0c ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000141; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/dllinject/reverse_tcp_allports, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 12 31 c0 66 8b 46 02 86 e0 66 40 86 e0 66 89 46 02 eb df 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000142; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/dllinject/reverse_tcp_dns, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 eb 2f 68 a9 28 34 80 ff d5 8b 40 1c 6a 05 50 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 51 ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 e8 cc ff ff ff |"; content:"| 00 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 00 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 |"; content:"| 00 56 6a 00 68 |"; content:"| a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000143; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/meterpreter/reverse_http, extract=true"; flow:established; content:"| fc e8 ac 00 00 00 53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 49 6e 74 65 72 6e 65 74 20 53 65 74 74 69 6e 67 73 5c 5a 6f 6e 65 73 5c 33 00 31 30 30 34 31 32 30 30 31 32 30 31 31 30 30 31 43 3a 5c 70 72 6f 67 72 61 7e 31 5c 69 6e 74 65 72 6e 7e 31 5c 69 65 78 70 6c 6f 72 65 20 2d 6e 65 77 20 68 74 74 70 3a 2f 2f |"; content:"| 3a 38 30 30 30 2f |"; content:"| 00 e8 4e 00 00 00 60 8b 6c 24 24 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb e3 32 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 28 75 e3 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 8b 04 8b 01 e8 89 44 24 1c 61 c2 08 00 5f 5b 31 d2 64 8b 42 30 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 83 c0 7c 8b 40 3c 89 e5 68 7e d8 e2 73 50 68 72 fe b3 16 50 68 8e 4e 0e ec 50 ff d7 96 ff d7 89 45 00 ff d7 89 45 04 52 68 70 69 33 32 |"; content:"| 68 61 64 76 61 54 ff d6 68 a9 2b 92 02 50 68 dd 9a 1c 2d 50 ff d7 89 45 08 ff d7 97 87 f3 54 56 68 01 00 00 |"; content:"| ff d7 5b 83 c6 44 50 89 e7 80 3e 43 74 1b 50 ad 50 89 e0 6a 04 57 6a 04 6a 00 50 53 ff 55 08 eb e8 8a 0d 30 00 fe 7f 88 0e 6a 54 59 29 cc 89 e7 57 f3 aa 5f c6 07 44 fe 47 2c fe 47 2d 68 75 6c 74 00 68 44 65 66 61 68 74 61 30 5c 68 57 69 6e 53 89 67 08 8d 5f 44 53 57 50 50 6a 10 50 50 50 56 50 ff 55 00 ff 55 04 |"; sid:8000144; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/meterpreter/reverse_https, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 6e 65 74 00 68 77 69 6e 69 89 e6 54 68 4c 77 26 07 ff d5 31 ff 57 57 57 57 56 68 3a 56 79 a7 ff d5 eb 5f 5b 31 c9 51 51 6a 03 51 51 68 |"; content:"| 00 00 00 53 50 68 57 89 9f c6 ff d5 eb 48 59 31 d2 52 68 00 32 e0 84 52 52 52 51 52 50 68 eb 55 2e 3b ff d5 89 c6 6a 02 5b 31 ff 57 57 57 57 56 68 2d 06 18 7b ff d5 85 c0 75 2e 4b 74 24 68 80 33 00 00 89 e0 6a 04 50 6a 1f 56 68 75 46 9e 86 ff d5 eb d5 eb 49 e8 b3 ff ff ff 2f 41 |"; content:"| 00 68 f0 b5 a2 56 ff d5 6a 40 68 00 10 00 00 68 00 00 40 00 57 68 58 a4 53 e5 ff d5 93 53 53 89 e7 57 68 00 20 00 00 53 56 68 12 96 89 |"; content:"| 85 c0 74 cd 8b 07 01 c3 85 c0 75 e5 58 c3 e8 51 ff ff ff |"; sid:8000145; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/meterpreter/reverse_ord_tcp, extract=true"; flow:established; content:"| fc 31 db 64 8b 43 30 8b 40 0c 8b 50 1c 8b 12 8b 72 20 ad ad 4e 03 06 3d 32 33 5f 32 75 ef 8b 6a 08 8b 45 3c 8b 4c 05 78 8b 4c 0d 1c 01 e9 8b 41 58 01 e8 8b 71 3c 01 ee 03 69 0c 53 6a 01 6a 02 ff d0 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e1 53 b7 0c 53 51 57 51 6a 10 51 57 56 ff e5 |"; sid:8000146; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/meterpreter/reverse_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 6a 05 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 0c ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000147; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/meterpreter/reverse_tcp_allports, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 12 31 c0 66 8b 46 02 86 e0 66 40 86 e0 66 89 46 02 eb df 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000148; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/meterpreter/reverse_tcp_dns, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 eb 2f 68 a9 28 34 80 ff d5 8b 40 1c 6a 05 50 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 51 ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 e8 cc ff ff ff |"; content:"| 00 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 00 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 |"; content:"| 00 56 6a 00 68 |"; content:"| a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000149; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/shell/reverse_http, extract=true"; flow:established; content:"| fc e8 ac 00 00 00 53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 49 6e 74 65 72 6e 65 74 20 53 65 74 74 69 6e 67 73 5c 5a 6f 6e 65 73 5c 33 00 31 30 30 34 31 32 30 30 31 32 30 31 31 30 30 31 43 3a 5c 70 72 6f 67 72 61 7e 31 5c 69 6e 74 65 72 6e 7e 31 5c 69 65 78 70 6c 6f 72 65 20 2d 6e 65 77 20 68 74 74 70 3a 2f 2f |"; content:"| 3a 38 30 30 30 2f |"; content:"| 00 e8 4e 00 00 00 60 8b 6c 24 24 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb e3 32 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 28 75 e3 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 8b 04 8b 01 e8 89 44 24 1c 61 c2 08 00 5f 5b 31 d2 64 8b 42 30 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 83 c0 7c 8b 40 3c 89 e5 68 7e d8 e2 73 50 68 72 fe b3 16 50 68 8e 4e 0e ec 50 ff d7 96 ff d7 89 45 00 ff d7 89 45 04 52 68 70 69 33 32 |"; content:"| 68 61 64 76 61 54 ff d6 68 a9 2b 92 02 50 68 dd 9a 1c 2d 50 ff d7 89 45 08 ff d7 97 87 f3 54 56 68 01 00 00 |"; content:"| ff d7 5b 83 c6 44 50 89 e7 80 3e 43 74 1b 50 ad 50 89 e0 6a 04 57 6a 04 6a 00 50 53 ff 55 08 eb e8 8a 0d 30 00 fe 7f 88 0e 6a 54 59 29 cc 89 e7 57 f3 aa 5f c6 07 44 fe 47 2c fe 47 2d 68 75 6c 74 00 68 44 65 66 61 68 74 61 30 5c 68 57 69 6e 53 89 67 08 8d 5f 44 53 57 50 50 6a 10 50 50 50 56 50 ff 55 00 ff 55 04 |"; sid:8000150; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/shell/reverse_nonx_tcp, extract=true"; flow:established; content:"| fc 6a eb 47 e8 f9 ff ff ff 60 31 db 8b 7d 3c 8b 7c 3d 78 01 ef 8b 57 20 01 ea 8b 34 9a 01 ee 31 c0 99 ac c1 ca 0d 01 c2 84 c0 75 f6 43 66 39 ca 75 e3 4b 8b 4f 24 01 e9 66 8b 1c 59 8b 4f 1c 01 e9 03 2c 99 89 6c 24 1c 61 ff e0 31 db 64 8b 43 30 8b 40 0c 8b 70 1c ad 8b 68 08 5e 66 53 66 68 33 32 68 77 73 32 5f 54 66 b9 72 60 ff d6 95 53 53 53 53 43 53 43 53 89 e7 66 81 ef 08 02 57 53 66 b9 e7 df ff d6 66 b9 a8 6f ff d6 97 68 |"; content:"| 66 53 89 e3 6a 10 53 57 66 b9 57 05 ff d6 50 b4 0c 50 53 57 53 66 b9 c0 38 ff e6 |"; sid:8000151; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/shell/reverse_ord_tcp, extract=true"; flow:established; content:"| fc 31 db 64 8b 43 30 8b 40 0c 8b 50 1c 8b 12 8b 72 20 ad ad 4e 03 06 3d 32 33 5f 32 75 ef 8b 6a 08 8b 45 3c 8b 4c 05 78 8b 4c 0d 1c 01 e9 8b 41 58 01 e8 8b 71 3c 01 ee 03 69 0c 53 6a 01 6a 02 ff d0 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e1 53 b7 0c 53 51 57 51 6a 10 51 57 56 ff e5 |"; sid:8000152; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/shell/reverse_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 6a 05 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 0c ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000153; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/shell/reverse_tcp_allports, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 12 31 c0 66 8b 46 02 86 e0 66 40 86 e0 66 89 46 02 eb df 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000154; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/shell/reverse_tcp_dns, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 eb 2f 68 a9 28 34 80 ff d5 8b 40 1c 6a 05 50 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 51 ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 e8 cc ff ff ff |"; content:"| 00 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 00 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 |"; content:"| 00 56 6a 00 68 |"; content:"| a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000155; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/shell_reverse_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 89 c7 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 68 63 6d 64 00 89 e3 57 57 57 31 f6 6a 12 59 56 e2 fd 66 c7 44 24 3c 01 01 8d 44 24 10 c6 00 44 54 50 56 56 56 46 56 4e 56 56 53 56 68 79 cc 3f 86 ff d5 89 e0 4e 56 46 ff 30 68 08 87 1d 60 ff d5 bb f0 b5 a2 56 68 a6 95 bd 9d ff d5 3c 06 7c 0a 80 fb e0 75 05 bb 47 13 72 6f 6a 00 53 ff d5 |"; sid:8000156; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/upexec/reverse_http, extract=true"; flow:established; content:"| fc e8 ac 00 00 00 53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 49 6e 74 65 72 6e 65 74 20 53 65 74 74 69 6e 67 73 5c 5a 6f 6e 65 73 5c 33 00 31 30 30 34 31 32 30 30 31 32 30 31 31 30 30 31 43 3a 5c 70 72 6f 67 72 61 7e 31 5c 69 6e 74 65 72 6e 7e 31 5c 69 65 78 70 6c 6f 72 65 20 2d 6e 65 77 20 68 74 74 70 3a 2f 2f |"; content:"| 3a 38 30 30 30 2f |"; content:"| 00 e8 4e 00 00 00 60 8b 6c 24 24 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb e3 32 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 28 75 e3 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 8b 04 8b 01 e8 89 44 24 1c 61 c2 08 00 5f 5b 31 d2 64 8b 42 30 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 83 c0 7c 8b 40 3c 89 e5 68 7e d8 e2 73 50 68 72 fe b3 16 50 68 8e 4e 0e ec 50 ff d7 96 ff d7 89 45 00 ff d7 89 45 04 52 68 70 69 33 32 |"; content:"| 68 61 64 76 61 54 ff d6 68 a9 2b 92 02 50 68 dd 9a 1c 2d 50 ff d7 89 45 08 ff d7 97 87 f3 54 56 68 01 00 00 |"; content:"| ff d7 5b 83 c6 44 50 89 e7 80 3e 43 74 1b 50 ad 50 89 e0 6a 04 57 6a 04 6a 00 50 53 ff 55 08 eb e8 8a 0d 30 00 fe 7f 88 0e 6a 54 59 29 cc 89 e7 57 f3 aa 5f c6 07 44 fe 47 2c fe 47 2d 68 75 6c 74 00 68 44 65 66 61 68 74 61 30 5c 68 57 69 6e 53 89 67 08 8d 5f 44 53 57 50 50 6a 10 50 50 50 56 50 ff 55 00 ff 55 04 |"; sid:8000157; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/upexec/reverse_ipv6_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 04 02 00 00 29 c4 48 48 54 50 68 29 80 6b 00 ff d5 50 50 50 6a 06 40 50 6a 17 68 ea 0f df e0 ff d5 89 c7 6a 1c e8 1c 00 00 00 17 00 00 |"; content:"| 00 00 00 00 fe 80 00 00 00 00 00 00 00 00 5e fe |"; content:"| 00 00 00 00 57 68 99 a5 74 61 ff d5 89 e6 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000158; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/upexec/reverse_nonx_tcp, extract=true"; flow:established; content:"| fc 6a eb 47 e8 f9 ff ff ff 60 31 db 8b 7d 3c 8b 7c 3d 78 01 ef 8b 57 20 01 ea 8b 34 9a 01 ee 31 c0 99 ac c1 ca 0d 01 c2 84 c0 75 f6 43 66 39 ca 75 e3 4b 8b 4f 24 01 e9 66 8b 1c 59 8b 4f 1c 01 e9 03 2c 99 89 6c 24 1c 61 ff e0 31 db 64 8b 43 30 8b 40 0c 8b 70 1c ad 8b 68 08 5e 66 53 66 68 33 32 68 77 73 32 5f 54 66 b9 72 60 ff d6 95 53 53 53 53 43 53 43 53 89 e7 66 81 ef 08 02 57 53 66 b9 e7 df ff d6 66 b9 a8 6f ff d6 97 68 |"; content:"| 66 53 89 e3 6a 10 53 57 66 b9 57 05 ff d6 50 b4 0c 50 53 57 53 66 b9 c0 38 ff e6 |"; sid:8000159; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/upexec/reverse_ord_tcp, extract=true"; flow:established; content:"| fc 31 db 64 8b 43 30 8b 40 0c 8b 50 1c 8b 12 8b 72 20 ad ad 4e 03 06 3d 32 33 5f 32 75 ef 8b 6a 08 8b 45 3c 8b 4c 05 78 8b 4c 0d 1c 01 e9 8b 41 58 01 e8 8b 71 3c 01 ee 03 69 0c 53 6a 01 6a 02 ff d0 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e1 53 b7 0c 53 51 57 51 6a 10 51 57 56 ff e5 |"; sid:8000160; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/upexec/reverse_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 6a 05 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 0c ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000161; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/upexec/reverse_tcp_allports, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 12 31 c0 66 8b 46 02 86 e0 66 40 86 e0 66 89 46 02 eb df 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000162; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/upexec/reverse_tcp_dns, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 eb 2f 68 a9 28 34 80 ff d5 8b 40 1c 6a 05 50 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 51 ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 e8 cc ff ff ff |"; content:"| 00 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 00 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 |"; content:"| 00 56 6a 00 68 |"; content:"| a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000163; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/vncinject/reverse_http, extract=true"; flow:established; content:"| fc e8 ac 00 00 00 53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 49 6e 74 65 72 6e 65 74 20 53 65 74 74 69 6e 67 73 5c 5a 6f 6e 65 73 5c 33 00 31 30 30 34 31 32 30 30 31 32 30 31 31 30 30 31 43 3a 5c 70 72 6f 67 72 61 7e 31 5c 69 6e 74 65 72 6e 7e 31 5c 69 65 78 70 6c 6f 72 65 20 2d 6e 65 77 20 68 74 74 70 3a 2f 2f |"; content:"| 3a 38 30 30 30 2f |"; content:"| 00 e8 4e 00 00 00 60 8b 6c 24 24 8b 45 3c 8b 7c 05 78 01 ef 8b 4f 18 8b 5f 20 01 eb e3 32 49 8b 34 8b 01 ee 31 c0 99 ac 84 c0 74 07 c1 ca 0d 01 c2 eb f4 3b 54 24 28 75 e3 8b 5f 24 01 eb 66 8b 0c 4b 8b 5f 1c 01 eb 8b 04 8b 01 e8 89 44 24 1c 61 c2 08 00 5f 5b 31 d2 64 8b 42 30 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 83 c0 7c 8b 40 3c 89 e5 68 7e d8 e2 73 50 68 72 fe b3 16 50 68 8e 4e 0e ec 50 ff d7 96 ff d7 89 45 00 ff d7 89 45 04 52 68 70 69 33 32 |"; content:"| 68 61 64 76 61 54 ff d6 68 a9 2b 92 02 50 68 dd 9a 1c 2d 50 ff d7 89 45 08 ff d7 97 87 f3 54 56 68 01 00 00 |"; content:"| ff d7 5b 83 c6 44 50 89 e7 80 3e 43 74 1b 50 ad 50 89 e0 6a 04 57 6a 04 6a 00 50 53 ff 55 08 eb e8 8a 0d 30 00 fe 7f 88 0e 6a 54 59 29 cc 89 e7 57 f3 aa 5f c6 07 44 fe 47 2c fe 47 2d 68 75 6c 74 00 68 44 65 66 61 68 74 61 30 5c 68 57 69 6e 53 89 67 08 8d 5f 44 53 57 50 50 6a 10 50 50 50 56 50 ff 55 00 ff 55 04 |"; sid:8000164; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/vncinject/reverse_ipv6_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 04 02 00 00 29 c4 48 48 54 50 68 29 80 6b 00 ff d5 50 50 50 6a 06 40 50 6a 17 68 ea 0f df e0 ff d5 89 c7 6a 1c e8 1c 00 00 00 17 00 00 |"; content:"| 00 00 00 00 fe 80 00 00 00 00 00 00 00 00 5e fe |"; content:"| 00 00 00 00 57 68 99 a5 74 61 ff d5 89 e6 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000165; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/vncinject/reverse_nonx_tcp, extract=true"; flow:established; content:"| fc 6a eb 47 e8 f9 ff ff ff 60 31 db 8b 7d 3c 8b 7c 3d 78 01 ef 8b 57 20 01 ea 8b 34 9a 01 ee 31 c0 99 ac c1 ca 0d 01 c2 84 c0 75 f6 43 66 39 ca 75 e3 4b 8b 4f 24 01 e9 66 8b 1c 59 8b 4f 1c 01 e9 03 2c 99 89 6c 24 1c 61 ff e0 31 db 64 8b 43 30 8b 40 0c 8b 70 1c ad 8b 68 08 5e 66 53 66 68 33 32 68 77 73 32 5f 54 66 b9 72 60 ff d6 95 53 53 53 53 43 53 43 53 89 e7 66 81 ef 08 02 57 53 66 b9 e7 df ff d6 66 b9 a8 6f ff d6 97 68 |"; content:"| 66 53 89 e3 6a 10 53 57 66 b9 57 05 ff d6 50 b4 0c 50 53 57 53 66 b9 c0 38 ff e6 |"; sid:8000166; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/vncinject/reverse_ord_tcp, extract=true"; flow:established; content:"| fc 31 db 64 8b 43 30 8b 40 0c 8b 50 1c 8b 12 8b 72 20 ad ad 4e 03 06 3d 32 33 5f 32 75 ef 8b 6a 08 8b 45 3c 8b 4c 05 78 8b 4c 0d 1c 01 e9 8b 41 58 01 e8 8b 71 3c 01 ee 03 69 0c 53 6a 01 6a 02 ff d0 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e1 53 b7 0c 53 51 57 51 6a 10 51 57 56 ff e5 |"; sid:8000167; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/vncinject/reverse_tcp, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 6a 05 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 0c ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000168; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/vncinject/reverse_tcp_allports, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 68 |"; content:"| 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 12 31 c0 66 8b 46 02 86 e0 66 40 86 e0 66 89 46 02 eb df 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 00 56 6a 00 68 58 a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000169; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/vncinject/reverse_tcp_dns, extract=true"; flow:established; content:"| fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b 52 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff 31 c0 ac 3c 61 7c 02 2c 20 c1 cf 0d 01 c7 e2 f0 52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4a 01 d0 50 8b 48 18 8b 58 20 01 d3 e3 3c 49 8b 34 8b 01 d6 31 ff 31 c0 ac c1 cf 0d 01 c7 38 e0 75 f4 03 7d f8 3b 7d 24 75 e2 58 8b 58 24 01 d3 66 8b 0c 4b 8b 58 1c 01 d3 8b 04 8b 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 58 5f 5a 8b 12 eb 86 5d 68 33 32 00 00 68 77 73 32 5f 54 68 4c 77 26 07 ff d5 b8 90 01 00 00 29 c4 54 50 68 29 80 6b 00 ff d5 50 50 50 50 40 50 40 50 68 ea 0f df e0 ff d5 97 eb 2f 68 a9 28 34 80 ff d5 8b 40 1c 6a 05 50 68 02 00 00 |"; content:"| 89 e6 6a 10 56 57 68 99 a5 74 61 ff d5 85 c0 74 51 ff 4e 08 75 ec 68 f0 b5 a2 56 ff d5 e8 cc ff ff ff |"; content:"| 00 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 00 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 8b 36 6a 40 68 00 10 00 |"; content:"| 00 56 6a 00 68 |"; content:"| a4 53 e5 ff d5 93 53 6a 00 56 53 57 68 02 d9 c8 5f ff d5 01 c3 29 c6 85 f6 75 ec c3 |"; sid:8000170; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/x64/meterpreter/reverse_tcp, extract=true"; flow:established; content:"| fc 48 83 e4 f0 e8 c0 00 00 00 41 51 41 50 52 51 56 48 31 d2 65 48 8b 52 60 48 8b 52 18 48 8b 52 20 48 8b 72 50 48 0f b7 4a 4a 4d 31 c9 48 31 c0 ac 3c 61 7c 02 2c 20 41 c1 c9 0d 41 01 c1 e2 ed 52 41 51 48 8b 52 20 8b 42 3c 48 01 d0 8b 80 88 00 00 00 48 85 c0 74 67 48 01 d0 50 8b 48 18 44 8b 40 20 49 01 d0 e3 56 48 ff c9 41 8b 34 88 48 01 d6 4d 31 c9 48 31 c0 ac 41 c1 c9 0d 41 01 c1 38 e0 75 f1 4c 03 4c 24 08 45 39 d1 75 d8 58 44 8b 40 24 49 01 d0 66 41 8b 0c 48 44 8b 40 1c 49 01 d0 41 8b 04 88 48 01 d0 41 58 41 58 5e 59 5a 41 58 41 59 41 5a 48 83 ec 20 41 52 ff e0 58 41 59 5a 48 8b 12 e9 57 ff ff ff 5d 49 be 77 73 32 5f 33 32 00 00 41 56 49 89 e6 48 81 ec a0 01 00 00 49 89 e5 49 bc 02 00 00 |"; content:"| 41 54 49 89 e4 4c 89 f1 41 ba 4c 77 26 07 ff d5 4c 89 ea 68 01 01 00 00 59 41 ba 29 80 6b 00 ff d5 50 50 4d 31 c9 4d 31 c0 48 ff c0 48 89 c2 48 ff c0 48 89 c1 41 ba ea 0f df e0 ff d5 48 89 c7 6a 10 41 58 4c 89 e2 48 89 f9 41 ba 99 a5 74 61 ff d5 48 81 c4 40 02 00 00 48 83 ec 10 48 89 |"; content:"| 6a 04 41 58 48 89 f9 41 ba 02 d9 c8 5f ff d5 48 83 c4 20 5e 6a 40 41 59 68 00 10 00 00 41 58 48 89 f2 48 31 c9 41 ba 58 a4 53 e5 ff d5 48 89 c3 49 89 c7 4d 31 c9 49 89 f0 48 89 da 48 89 f9 41 ba 02 d9 c8 5f ff d5 48 01 c3 48 29 c6 48 85 f6 75 e1 41 ff e7 |"; sid:8000171; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/x64/shell/reverse_tcp, extract=true"; flow:established; content:"| fc 48 83 e4 f0 e8 c0 00 00 00 41 51 41 50 52 51 56 48 31 d2 65 48 8b 52 60 48 8b 52 18 48 8b 52 20 48 8b 72 50 48 0f b7 4a 4a 4d 31 c9 48 31 c0 ac 3c 61 7c 02 2c 20 41 c1 c9 0d 41 01 c1 e2 ed 52 41 51 48 8b 52 20 8b 42 3c 48 01 d0 8b 80 88 00 00 00 48 85 c0 74 67 48 01 d0 50 8b 48 18 44 8b 40 20 49 01 d0 e3 56 48 ff c9 41 8b 34 88 48 01 d6 4d 31 c9 48 31 c0 ac 41 c1 c9 0d 41 01 c1 38 e0 75 f1 4c 03 4c 24 08 45 39 d1 75 d8 58 44 8b 40 24 49 01 d0 66 41 8b 0c 48 44 8b 40 1c 49 01 d0 41 8b 04 88 48 01 d0 41 58 41 58 5e 59 5a 41 58 41 59 41 5a 48 83 ec 20 41 52 ff e0 58 41 59 5a 48 8b 12 e9 57 ff ff ff 5d 49 be 77 73 32 5f 33 32 00 00 41 56 49 89 e6 48 81 ec a0 01 00 00 49 89 e5 49 bc 02 00 00 |"; content:"| 41 54 49 89 e4 4c 89 f1 41 ba 4c 77 26 07 ff d5 4c 89 ea 68 01 01 00 00 59 41 ba 29 80 6b 00 ff d5 50 50 4d 31 c9 4d 31 c0 48 ff c0 48 89 c2 48 ff c0 48 89 c1 41 ba ea 0f df e0 ff d5 48 89 c7 6a 10 41 58 4c 89 e2 48 89 f9 41 ba 99 a5 74 61 ff d5 48 81 c4 40 02 00 00 48 83 ec 10 48 89 |"; content:"| 6a 04 41 58 48 89 f9 41 ba 02 d9 c8 5f ff d5 48 83 c4 20 5e 6a 40 41 59 68 00 10 00 00 41 58 48 89 f2 48 31 c9 41 ba 58 a4 53 e5 ff d5 48 89 c3 49 89 c7 4d 31 c9 49 89 f0 48 89 da 48 89 f9 41 ba 02 d9 c8 5f ff d5 48 01 c3 48 29 c6 48 85 f6 75 e1 41 ff e7 |"; sid:8000172; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/x64/shell_reverse_tcp, extract=true"; flow:established; content:"| fc 48 83 e4 f0 e8 c0 00 00 00 41 51 41 50 52 51 56 48 31 d2 65 48 8b 52 60 48 8b 52 18 48 8b 52 20 48 8b 72 50 48 0f b7 4a 4a 4d 31 c9 48 31 c0 ac 3c 61 7c 02 2c 20 41 c1 c9 0d 41 01 c1 e2 ed 52 41 51 48 8b 52 20 8b 42 3c 48 01 d0 8b 80 88 00 00 00 48 85 c0 74 67 48 01 d0 50 8b 48 18 44 8b 40 20 49 01 d0 e3 56 48 ff c9 41 8b 34 88 48 01 d6 4d 31 c9 48 31 c0 ac 41 c1 c9 0d 41 01 c1 38 e0 75 f1 4c 03 4c 24 08 45 39 d1 75 d8 58 44 8b 40 24 49 01 d0 66 41 8b 0c 48 44 8b 40 1c 49 01 d0 41 8b 04 88 48 01 d0 41 58 41 58 5e 59 5a 41 58 41 59 41 5a 48 83 ec 20 41 52 ff e0 58 41 59 5a 48 8b 12 e9 57 ff ff ff 5d 49 be 77 73 32 5f 33 32 00 00 41 56 49 89 e6 48 81 ec a0 01 00 00 49 89 e5 49 bc 02 00 00 |"; content:"| 41 54 49 89 e4 4c 89 f1 41 ba 4c 77 26 07 ff d5 4c 89 ea 68 01 01 00 00 59 41 ba 29 80 6b 00 ff d5 50 50 4d 31 c9 4d 31 c0 48 ff c0 48 89 c2 48 ff c0 48 89 c1 41 ba ea 0f df e0 ff d5 48 89 c7 6a 10 41 58 4c 89 e2 48 89 f9 41 ba 99 a5 74 61 ff d5 48 81 c4 40 02 00 00 49 b8 63 6d 64 00 |"; content:"| 41 50 41 50 48 89 e2 57 57 57 4d 31 c0 6a 0d 59 41 50 e2 fc 66 c7 44 24 54 01 01 48 8d 44 24 18 c6 00 68 48 89 e6 56 50 41 50 41 50 41 50 49 ff c0 41 50 49 ff c8 4d 89 c1 4c 89 c1 41 ba 79 cc 3f 86 ff d5 48 31 d2 48 ff ca 8b 0e 41 ba 08 87 1d 60 ff d5 bb f0 b5 a2 56 41 ba a6 95 bd 9d ff d5 48 83 c4 28 3c 06 7c 0a 80 fb e0 75 05 bb 47 13 72 6f 6a 00 59 41 89 da ff d5 |"; sid:8000173; rev:1;)
alert tcp any any -> any any (msg:"ZB Metasploit_windows/x64/vncinject/reverse_tcp, extract=true"; flow:established; content:"| fc 48 83 e4 f0 e8 c0 00 00 00 41 51 41 50 52 51 56 48 31 d2 65 48 8b 52 60 48 8b 52 18 48 8b 52 20 48 8b 72 50 48 0f b7 4a 4a 4d 31 c9 48 31 c0 ac 3c 61 7c 02 2c 20 41 c1 c9 0d 41 01 c1 e2 ed 52 41 51 48 8b 52 20 8b 42 3c 48 01 d0 8b 80 88 00 00 00 48 85 c0 74 67 48 01 d0 50 8b 48 18 44 8b 40 20 49 01 d0 e3 56 48 ff c9 41 8b 34 88 48 01 d6 4d 31 c9 48 31 c0 ac 41 c1 c9 0d 41 01 c1 38 e0 75 f1 4c 03 4c 24 08 45 39 d1 75 d8 58 44 8b 40 24 49 01 d0 66 41 8b 0c 48 44 8b 40 1c 49 01 d0 41 8b 04 88 48 01 d0 41 58 41 58 5e 59 5a 41 58 41 59 41 5a 48 83 ec 20 41 52 ff e0 58 41 59 5a 48 8b 12 e9 57 ff ff ff 5d 49 be 77 73 32 5f 33 32 00 00 41 56 49 89 e6 48 81 ec a0 01 00 00 49 89 e5 49 bc 02 00 00 |"; content:"| 41 54 49 89 e4 4c 89 f1 41 ba 4c 77 26 07 ff d5 4c 89 ea 68 01 01 00 00 59 41 ba 29 80 6b 00 ff d5 50 50 4d 31 c9 4d 31 c0 48 ff c0 48 89 c2 48 ff c0 48 89 c1 41 ba ea 0f df e0 ff d5 48 89 c7 6a 10 41 58 4c 89 e2 48 89 f9 41 ba 99 a5 74 61 ff d5 48 81 c4 40 02 00 00 48 83 ec 10 48 89 |"; content:"| 6a 04 41 58 48 89 f9 41 ba 02 d9 c8 5f ff d5 48 83 c4 20 5e 6a 40 41 59 68 00 10 00 00 41 58 48 89 f2 48 31 c9 41 ba 58 a4 53 e5 ff d5 48 89 c3 49 89 c7 4d 31 c9 49 89 f0 48 89 da 48 89 f9 41 ba 02 d9 c8 5f ff d5 48 01 c3 48 29 c6 48 85 f6 75 e1 41 ff e7 |"; sid:8000174; rev:1;)
#Dan Aug 30, 2017
alert tcp any any -> any 80 (msg:"ZB Brickcom_IP_Camera.Credentials_Disclosure"; flow:to_server,established; content:"GET "; depth:4; content:"/cgi-bin/users.cgi?action=getUsers"; fast_pattern; distance:0; content:" HTTP/1.1|0d 0a|"; distance:0; reference:url, AP-3512; sid:8000175; rev:1; )
#Dan Aug 31, 2017
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"ZB ChinaChopper.WebShell"; flow:to_server,established; content:"POST "; depth:5; content:" HTTP/1.1|0d 0a|"; distance:0; content: ".FromBase64String"; fast_pattern; distance:0; content: "&z1="; distance:0; reference:url, AP-3518; sid:8000176; rev:1; )
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"ZB WSO.WebShell"; flow:established,to_server; content:"POST "; within:5; content:"|0d 0a 0d 0a|"; distance:0; content:"&c="; content:"&p1="; content:"&p2="; content:"&p3="; fast_pattern; pcre:"/a=(?:S(?:e(?:lfRemove|cInfo)|tringTools|afeMode|ql)|(?:Bruteforc|Consol)e|FilesMan|Network|Logout|Php)/P"; reference:url, AP-3518; sid:8000177; rev:1;)
alert tcp any 80 -> any any (msg:"ZB C99.PHPWebShell"; flow:established,to_client; content:"c99shell"; reference:url, AP-3518; sid:8000179; rev:1;)
alert tcp any 80 -> any any (msg:"ZB C99.PHPWebShell"; flow:established,to_client; content:"C99 Modified"; reference:url, AP-3518; sid:8000180; rev:1;)
alert tcp any 80 -> any any (msg:"ZB C99.ImageWebShell"; flow:established,to_client; content:"Content-Type|3a| image/"; file_data; content:"eval(gzinflate(base64_decode("; distance:0; fast_pattern; reference:url, AP-3518; sid:8000181; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"ZB C99.WebShell_Multipart"; flow:established,to_server; content:"POST "; within:5; content:"|0d 0a 0d 0a|"; distance:0; content:"form-data\; name=|22|a|22|"; content:"form-data\; name=|22|c|22|"; content:"form-data\; name=|22|p1|22|"; reference:url, AP-3518; sid:8000182; rev:1;)
alert tcp any 80 -> any any (msg:"ZB C99.WebShellHeader"; flow:established,to_client; file_data; content:"Software|3a|"; content:"uname -a|3a|"; content:"uid="; reference:url, AP-3518; sid:8000183; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"ZB C99.Backdoor"; flow:to_server,established; content:"c99shcook["; nocase; fast_pattern:only; ; pcre:"/(?:^|&)c99shcook\[/Pi";  reference:url, AP-3518; sid:8000184; rev:1;)

#alert tcp any any -> any any (msg: "ZB MZ_Binary.Download.Suspicious"; flow:established; content:"MZ"; isdataat: 76,relative; content:"This program cannot be run in DOS mode."; distance: 0; isdataat: 10,relative; content:"PE"; distance: 0; reference:url,AP-3462; sid:8000185; rev:1; )

#Dan Sep 10, 2017
alert tcp any any -> any any (msg:"ZB Apache.Struts.RCE-CVE-2017-9805"; flow:to_server,established; content:"POST "; depth:5;  content:"/struts2-rest-showcase/orders/3 HTTP/1.1|0d 0a|"; distance:0; fast_pattern; content:"java.lang.Runtime"; nocase; distance:0; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; sid:8000187; rev:1; )

#Dan Sep 20, 2017
alert tcp any any -> any 80 (msg:"ZB NetCam-F7D7601.RemoteExecution.IoT"; content:"POST "; depth:5;  content:"/goform/SystemCommand?command="; distance:0; fast_pattern; content:" HTTP/1.1|0d 0a|"; distance:0; reference:url,AP-3561; sid:8000188; rev:1; )
alert tcp any any -> any 80 (msg:"ZB WiPG-1000.PrivilegeEscalation.IoT"; content:"POST "; depth:5;  content:"/cgi-bin/return_test.cgi HTTP/1.1|0d 0a|"; distance:0; content:"|0d 0a 0d 0a|command="; distance:0; content:"<name>LONG_ADMIN_PWD</name>"; fast_pattern; distance:0; reference:url,AP-3704; sid:8000189; rev:1; )
alert tcp any any -> any 80 (msg:"ZB WiPG-1000.AuthenticationBypass.IoT"; content:"POST "; depth:5;  content:"/cgi-bin/return_test.cgi HTTP/1.1|0d 0a|"; distance:0; content:"|0d 0a 0d 0a|command=<Send><noNeedSeid>"; fast_pattern; distance:0; reference:url,AP-3704; sid:8000190; rev:1; )
alert tcp any any -> any 80 (msg:"ZB WiPG-1000.CommandInjection.IoT"; content:"POST "; depth:5;  content:"/cgi-bin/rdfs.cgi HTTP/1.1|0d 0a|"; distance:0; fast_pattern; content:"|0d 0a 0d 0a|Client="; distance:0; reference:url,AP-3704; sid:8000191; rev:1; )

#Dan Sep 22, 2017
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0c|ab6d54340c1a|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724; reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000192; rev:1;)
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0c|aba9a949bc1d|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724; reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000193; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0d|ab2da3d400c20|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724; reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000194; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0c|ab3520430c23|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724; reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000195; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0d|ab1c403220c27|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724;  reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000196; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0d|ab1abad1d0c2a|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724;  reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000197; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0b|ab8cee60c2d|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724;  reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000198; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0d|ab1145b758c30|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724;  reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000199; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0c|ab890e964c34|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724;  reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000200; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0c|ab3d685a0c37|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724;  reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html; sid:8000201; rev:1; )
alert udp any any -> any 53 (msg:"ZB CCleaner.Backdoor.DGA"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0c|ab70a139cc3a|03|com|00|"; nocase; distance:0; fast_pattern; reference:url,AP-3724;  reference:url,blog.talosintelligence.com/2017/09/avast-distributes-malware.html;  sid:8000202; rev:1; )
alert tcp any any -> any 80 (msg:"ZB CCleaner.Vulnerable_Version_5.33.6162"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1."; distance:0; content:"|0d 0a|User-Agent: Mozilla/4.0 (CCleaner, 5.33.6162)"; fast_pattern; distance:0; reference:url,AP-3724; sid:8000203; rev:1; )

#New Locky variant
alert tcp any any -> any 80 (msg:"ZB Locky.Ransomware"; flow:to_server,established; content:"GET "; depth:4; content:"/87thiuh3gfDGS HTTP/1."; distance:0; fast_pattern; reference:url,AP-3725; sid:8000204; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Locky.Ransomware"; flow:to_server,established; content:"GET "; depth:4; content:"/DKndhFG72 HTTP/1."; distance:0; fast_pattern; reference:url,AP-3725; sid:8000205; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Locky.Ransomware"; flow:to_server,established; content:"GET "; depth:4; content:"/JGHldb03m HTTP/1."; distance:0; fast_pattern; reference:url,AP-3725; sid:8000206; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Locky.Ransomware"; flow:to_server,established; content:"GET "; depth:4; content:"/y873fhn3iur HTTP/1."; distance:0; fast_pattern; reference:url,AP-3725; sid:8000207; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Locky.Ransomware"; flow:to_server,established; content:"GET "; depth:4; content:"/RSkfsNR7 HTTP/1."; distance:0; fast_pattern; reference:url,AP-3725; sid:8000208; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Locky.Ransomware"; flow:to_server,established; content:"GET "; depth:4; content:"/slehGTexc HTTP/1."; distance:0; fast_pattern; reference:url,AP-3725; sid:8000209; rev:1; )

#Dan Oct 2, 2017
alert tcp any any -> any 80 (msg:"ZB Hikvision.AuthBypass.Attempt"; flow:to_server,established; content:"GET "; depth:4; content:"/Security/users?auth=YWRtaW46"; fast_pattern; distance:0; content:" HTTP/1."; distance:0; reference:url,AP-3794; sid:8000210; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Hikvision.AuthBypass.Attempt"; flow:to_server,established; content:"GET "; depth:4; content:"/onvif-http/snapshot?auth=YWRtaW46"; fast_pattern; distance:0; content:" HTTP/1."; distance:0; reference:url,AP-3794; sid:8000211; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Hikvision.AuthBypass.Attempt"; flow:to_server,established; content:"GET "; depth:4; content:"/System/configurationFile?auth=YWRtaW46"; fast_pattern; distance:0; content:" HTTP/1."; distance:0; reference:url,AP-3794; sid:8000212; rev:1; )

#Dan Oct 3, 2017
alert tcp any any -> any 80 (msg:"ZB Linux.ProxyM.Downloader"; flow:to_server,established; content:"GET "; depth:4; content:".armv4l HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|"; distance:0; reference:url,AP-3747; sid:8000213; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Linux.ProxyM.Downloader"; flow:to_server,established; content:"GET "; depth:4; content:".i586 HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|"; distance:0; reference:url,AP-3747; sid:8000214; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Linux.ProxyM.Downloader"; flow:to_server,established; content:"GET "; depth:4; content:".m68k HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|"; distance:0; reference:url,AP-3747; sid:8000215; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Linux.ProxyM.Downloader"; flow:to_server,established; content:"GET "; depth:4; content:".mips HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|"; distance:0; reference:url,AP-3747; sid:8000216; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Linux.ProxyM.Downloader"; flow:to_server,established; content:"GET "; depth:4; content:".mipsel HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|"; distance:0; reference:url,AP-3747; sid:8000217; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Linux.ProxyM.Downloader"; flow:to_server,established; content:"GET "; depth:4; content:".powerpc HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|"; distance:0; reference:url,AP-3747; sid:8000218; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Linux.ProxyM.Downloader"; flow:to_server,established; content:"GET "; depth:4; content:".sh4 HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|"; distance:0; reference:url,AP-3747; sid:8000219; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Linux.ProxyM.Downloader"; flow:to_server,established; content:"GET "; depth:4; content:".sparc HTTP/1."; fast_pattern; distance:0; content:"|0d 0a|"; distance:0; reference:url,AP-3747; sid:8000220; rev:1; )

#Dan Oct 6, 2017
alert tcp any any -> any any (msg:"ZB FormBook.InfoStealer"; flow:from_server,established; content:"HTTP/1.1 200 OK|0d 0a|"; content:"|0d 0a 0d 0a|FBNG"; fast_pattern;  sid:8000227; rev:1;)

#Dan Oct 10, 2017
alert tcp any any -> any 80 (msg:"ZB NetGear_ReadyNAS.RCE.Attempt"; flow:to_server,established; content:"GET "; depth:4; content:"/upgrade_handle.php?cmd=writeuploaddir&uploaddir="; fast_pattern;  sid:8000228; rev:1;)

#Dan Oct 19, 2017
alert tcp any any -> any any (msg:"ZB Gafgyt.Backdoor.Callback.IoT"; flow:to_client,established; content:"!* Beetlekill"; depth:13; fast_pattern;  sid:8000229; rev:1;)
#Dan Oct 20, 2017
alert tcp any any -> any 80 (msg:"ZB D-link.PasswordLeak.CVE-2017-14417.IoT"; flow:to_server,established; content:"POST "; depth:5; content:"/register_send.php "; fast_pattern; content:"|0d 0a 0d 0a|"; distance:0; content:"act=signup&"; distance:0; content:"&passwd="; content:"&firstname="; content:"&lastname="; sid:8000230; rev:1;)
alert tcp any any -> any 80 (msg:"ZB D-link.PasswordLeak.CVE-2017-14417.IoT"; flow:to_server,established; content:"POST "; depth:5; content:"/register_send.php "; fast_pattern; content:"|0d 0a 0d 0a|"; distance:0; content:"act=signin&"; distance:0; content:"&passwd="; content:"&firstname="; content:"&lastname="; reference:url,AP-3999; sid:8000231; rev:1;)
alert tcp any any -> any 80 (msg:"ZB D-link.PasswordLeak.CVE-2017-14417.IoT"; flow:to_server,established; content:"POST "; depth:5; content:"/register_send.php "; fast_pattern; content:"|0d 0a 0d 0a|"; distance:0; content:"act=adddev&lang="; distance:0; reference:url,AP-3999;  sid:8000232; rev:1;)
alert tcp any any -> any any (msg:"ZB D-link.CookieBufferOverflow.CVE-2016-5681.IoT"; flow:to_server,established; content:"POST "; depth:5; content:"/dws/api/Login HTTP/1."; fast_pattern; content:"|0d 0a|Cookie: uid="; distance:0; content:"|0d 0a 0d 0a|"; distance:0; content:"id="; distance:0; pcre:"/\x0d\x0aCookie: uid=[^\x0d\x0a]{3000,}/"; reference:url,AP-4004; sid:8000233; rev:1;)

#Dan Oct 23, 2017
alert tcp any any -> any 80 (msg:"ZB VACRON_CCTV.RCE.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/board.cgi?cmd="; fast_pattern; content:" HTTP/1.";  reference:url,AP-4015; sid:8000234; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 80 (msg:"ZB CookieBufferOverflow.Gen"; flow:to_server,established; content:"GET "; depth:4; content:"|0d 0a|Cookie: "; fast_pattern; distance:0; content:"|0d 0a 0d 0a|"; distance:0; pcre:"/\x0d\x0aCookie: [a-zA-Z0-9]{3,15}=[^\x3b\x0d\x0a]{500,}/"; reference:url,AP-4004; sid:8000235; rev:2;)
alert tcp any any -> any 80 (msg:"ZB Mirai.WiFiCAM.AuthBypass.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/system.ini?loginuse&loginpas HTTP/1.1|0d 0a|"; distance:0; fast_pattern; sid:8000236; rev:1;)
alert tcp any any -> any [80,8080] (msg:"ZB Reaper.Botnet.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/run.lua HTTP/1."; distance:0; fast_pattern; reference:url,AP-4019; sid:8000237; rev:1;)

#Dan Oct 24, 2017
alert tcp any any -> any 80 (msg:"ZB Fake.WindowsUpdate.Callback"; flow:to_server,established; content:"POST "; depth:5; content:"|0d 0a|User-Agent: Windows-Update-Agent|0d 0a|"; fast_pattern; distance:0; content:!".microsoft.com"; content:!".windowsupdate.com"; reference:url,4032;  sid:8000238; rev:1;)

#Dan Oct 25, 2017
alert tcp any any -> any 80 (msg:"ZB NetGear_DGN.RCE"; flow:to_server,established; content:"GET "; depth:4; content:"/setup.cgi?"; distance:0; content:"currentsetting.htm"; distance:0; fast_pattern; content:" HTTP/1."; distance:0; reference:url,AP-4061; sid:8000239; rev:1;)

#Dan Oct 25, 2017
alert tcp any any -> any 445 (msg:"ZB BadRabbit.SMB.Propagation"; flow:to_server,established; content:"|FF|SMB|A2|"; depth:5; offset:4; content:"|09 00|cscc.dat|00|"; fast_pattern:only; reference:url,AP-4030; reference:url,www.virustotal.com/en/file/579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648/analysis/; sid:8000240; rev:1;)
alert tcp any any -> any 445 (msg:"ZB BadRabbit.SMB2.Propagation"; flow:to_server,established; content:"|FE|SMB"; depth:4; offset:4; content:"|05 00|"; within:2; distance:8; content:"c|00|s|00|c|00|c|00|.|00|d|00|a|00|t"; fast_pattern:only; reference:url,AP-4030; reference:url,www.virustotal.com/en/file/579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648/analysis/; sid:8000241; rev:1;)
alert tcp any any -> any 445 (msg:"ZB BadRabbit.SMB.Propagation"; flow:to_server,established; content:"|FF|SMB|A2|"; depth:5; offset:4; content:"|0B 00|infpub.dat|00|"; fast_pattern:only; content:!"|5c|System32|5c|DriverStore|5c|"; reference:url,AP-4030; reference:url,www.virustotal.com/en/file/579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648/analysis/; sid:8000242; rev:1;)
alert tcp any any -> any 445 (msg:"ZB BadRabbit.SMB.Propagation"; flow:to_server,established; content:"|FE|SMB"; depth:4; offset:4; content:"|05 00|"; within:2; distance:8; content:"i|00|n|00|f|00|p|00|u|00|b|00|.|00|d|00|a|00|t"; fast_pattern:only; content:!"|5C 00 53 00 79 00 73 00 74 00 65 00 6D 00 33 00 32 00 5C 00 44 00 72 00 69 00 76 00 65 00 72 00 53 00 74 00 6F 00 72 00 65 00 5C|"; reference:url,AP-4030; reference:url,www.virustotal.com/en/file/579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648/analysis/; sid:8000243; rev:1;)
alert tcp any any -> any 445 (msg:"ZB BadRabbit.SMB-SVCCTL.Propagation"; flow:to_server,established; content:"|5C 00|r|00|u|00|n|00|d|00|l|00|l|00|3|00|2|00|.|00|e|00|x|00|e"; fast_pattern:only; content:"|5C 00|i|00|n|00|f|00|p|00|u|00|b|00|.|00|d|00|a|00|t"; nocase; content:!"|5C 00 53 00 79 00 73 00 74 00 65 00 6D 00 33 00 32 00 5C 00 44 00 72 00 69 00 76 00 65 00 72 00 53 00 74 00 6F 00 72 00 65 00 5C|"; reference:url,www.virustotal.com/en/file/579fd8a0385482fb4c789561a30b09f25671e86422f40ef5cca2036b28f99648/analysis/;  reference:url,AP-4030; sid:8000244; rev:1;)

#Dan Oct 30, 2017
alert tcp any any -> any any (msg:"ZB Teletrack.PHI.Leak.Suspicious"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; content:">MRN</option>"; fast_pattern; distance:0; content:">Bed</option>"; distance:0; content:">Soc. Sec #</option>"; distance:0; sid:8000245; rev:1; )

alert tcp any 80 -> any any (msg:"ZB SSN.Leak.Suspicious"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; fast_pattern; pcre:"/[^0-9a-zA-Z\-][1-9]{3,3}[-][1-9]{2,2}[-][1-9]{4,4}[^0-9a-zA-Z\-]/"; threshold: type limit, track by_src, count 1 , seconds 604800 ; sid:8000246; rev:1; )
alert tcp any any -> any 80 (msg:"ZB SSN.Leak.Suspicious"; flow:to_server,established; content:"GET "; depth:4; pcre:"/[^0-9a-zA-Z\-][1-9]{3,3}[-][1-9]{2,2}[-][1-9]{4,4}[^0-9a-zA-Z\-]/"; content:!"|0d 0a|Cookie"; distance:0; threshold: type limit, track by_dst, count 1 , seconds 604800 ; sid:8000247; rev:1; )
alert tcp any any -> any 80 (msg:"ZB SSN.Leak.Suspicious"; flow:to_server,established; content:"POST "; depth:5; pcre:"/[^0-9a-zA-Z\-][1-9]{3,3}[-][1-9]{2,2}[-][1-9]{4,4}[^0-9a-zA-Z\-]/"; content:!"|0d 0a|Cookie"; distance:0; threshold: type limit, track by_dst, count 1 , seconds 604800 ; sid:8000248; rev:1; )


# Detecting credit card details
alert tcp any any -> any [21,23,80] (msg:"ZB MasterCard.Leak.Suspicious"; content:"number";nocase; pcre:"/[^0-9a-zA-Z\-]5\d{3}(\s|-)\d{4}(\s|-)\d{4}(\s|-)\d{4}[^0-9a-zA-Z\-]/"; sid:8000249;rev:1;)
alert tcp any any -> any [21,23,80] (msg:"ZB AmericanExpress.Leak.Suspicious"; content:"number";nocase; pcre:"/[^0-9a-zA-Z\-]3\d{3}(\s|-)\d{6}(\s|-)\d{5}[^0-9a-zA-Z\-]/"; sid:8000250;rev:1;)
alert tcp any any -> any [21,23,80] (msg:"ZB VisaCard.Leak.Suspicious"; content:"number";nocase; pcre:"/[^0-9a-zA-Z\-]4\d{3}(\s|-)\d{4}(\s|-)\d{4}(\s|-)\d{4}[^0-9a-zA-Z\-]/"; sid:8000251;rev:1;)


#Dan Nov 02, 2017
alert tcp any any -> any 80 (msg:"ZB DentedBot.Callback"; flow:to_server,established; content:"POST "; depth:5; content:"|0d 0a|User-Agent: icel|0d 0a|"; fast_pattern; content:!"|0d 0a|Cookie"; sid:8000252; rev:1; )

#Dan Nov 03, 2017
#alert tcp any any -> any any (msg:"ZB Patient.Leak.Suspicious"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; fast_pattern; content:"patient"; nocase; content:"mrn"; nocase; content:"ssn"; nocase; sid:8000253; rev:1; )
#alert tcp any any -> any any (msg:"ZB Patient.Leak.Suspicious"; flow:to_server,established; content:"GET "; depth:4; content:"patient"; nocase; content:"mrn"; nocase; content:"ssn"; nocase; sid:8000254; rev:1; )
#alert tcp any any -> any any (msg:"ZB Patient.Leak.Suspicious"; flow:to_server,established; content:"POST "; depth:5; content:"patient"; nocase; content:"mrn"; nocase; content:"ssn"; nocase; sid:8000255; rev:1; )
#alert tcp any any -> any any (msg:"ZB Patient.Leak.Suspicious"; flow:established; content:"patient"; nocase; content:"address"; nocase; content:"name"; nocase; sid:8000255; rev:1; )

#Dan Nov 07, 2017
alert tcp any any -> any 80 (msg:"ZB GIBON.Ransomware.Callback"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1."; distance:0; content:"|0d 0a|User-Agent: GIBON|0d 0a|"; fast_pattern; sid:8000256; rev:1;)

#Dan Nov 14, 2017
alert tcp any any -> any any (msg:"ZB HiddenCobra.MaliciousSSL"; flow:to_server,established; content:"|17 03 01 00 08|";  pcre:"/\x17\x03\x01\x00\x08.{4}\x04\x88\x4d\x76/"; reference:url,AP-4237; rev:1; sid:8000257;)
alert tcp any any -> any any (msg:"ZB HiddenCobra.MaliciousSSL"; flow:to_server,established; content:"|17 03 01 00 08|";  pcre:"/\x17\x03\x01\x00\x08.{4}\x06\x88\x4d\x76/"; reference:url,AP-4237; rev:1; sid:8000258;)
alert tcp any any -> any any (msg:"ZB HiddenCobra.MaliciousSSL"; flow:to_server,established; content:"|17 03 01 00 08|";  pcre:"/\x17\x03\x01\x00\x08.{4}\xb2\x63\x70\x7b/"; reference:url,AP-4237; rev:1; sid:8000259;)
alert tcp any any -> any any (msg:"ZB HiddenCobra.MaliciousSSL"; flow:to_server,established; content:"|17 03 01 00 08|";  pcre:"/\x17\x03\x01\x00\x08.{4}\xb0\x63\x70\x7b/"; reference:url,AP-4237; rev:1; sid:8000260;)       

#Dan Nov 16, 2017
#08/14/2018 - Update
alert tcp any any -> any 80 (msg:"ZB Siemens_SM-2556.PasswordLeak.IoT, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"/pwliste.asp HTTP/1."; fast_pattern; distance:0; reference:url,AP-4258; sid:8000261; rev:1;)
#08/14/2018 - Update
alert tcp any any -> any 80 (msg:"ZB Siemens_SM-2556.MemoryDump.IoT, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"/webforms_readmem?"; fast_pattern; distance:0; content:"start_addr="; content:"length="; reference:url,AP-4258; sid:8000262; rev:1;)
#08/14/2018 - Update
alert tcp any any -> any 80 (msg:"ZB Siemens_SM-2556.XSS.IoT, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"/webforms_ping?"; fast_pattern; distance:0; content:"ip_address="; reference:url,AP-4258; sid:8000263; rev:1;)
#08/14/2018 - Update

#Nov 28, 2017
alert tcp any any -> any 25 (msg: "ZB Exim.UAF_RCE.CVE-2017-16943"; flow:established,to_server; content: "BDAT"; content: "BDAT"; within: 10; pcre: "/BDAT\s*\D[^\n\r]*[\n\r][^\n\r]{100}/"; reference: url,bugs.exim.org/show_bug.cgi?id=2199; sid: 8000264; rev: 1; )

#Nov 29, 2017
alert tcp any any -> any 80 (msg:"ZB HUAWEI-HG532e.RemoteExecution.IoT"; flow:established,to_server; content:"POST "; depth:5; content:"/ctrlt/DeviceUpgrade_1 HTTP/1.1|0d 0a|"; fast_pattern; content:"<NewDownloadURL>"; reference:url,AP-4355; sid:8000265; rev:1;)
#alert tcp any 80 -> any any (msg:"ZB Allegro.WebServer.IoT"; flow:established,to_client; content:"|0d 0a|Server: Allegro-Software-RomPager/"; fast_pattern; reference:url,AP-4241; sid:8000266; rev:1;)
#Dan Dec 14, 2017
alert tcp any any -> any 80 (msg:"ZB Mirai.Okiru.Callback.IoT"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1."; distance:0; content:"|0d 0a|User-Agent: Hello-World|0d 0a|"; fast_pattern; sid:8000267; rev:1;)
#Dan Dec 14, 2017
#alert tcp any any -> any any (msg:"ZB Busybox.RemoteExecution.IoT"; content:"/bin/busybox "; fast_pattern:only; sid:8000268; rev:1;)
#Dec 18, 2017
#08/14/2018 - Update
alert tcp any any -> any $HTTP_PORTS (msg:"ZB LD_PRELOAD.Generic, extract=true"; flow:established,to_server; content:"GET "; depth:4; content:"?LD_PRELOAD="; fast_pattern; http_uri; content:" HTTP/1."; distance:0; reference:url,AP-4535; sid:8000270; rev:1;)
#Jan 5, 2018
alert tcp any any -> any any (msg:"ZB Spectre.KernelMemory.Leak.JS"; flow:established,from_server; file_data; content:"<script"; content:"|3c 20|simpleByteArray.length|29|"; distance:0; content:"simpleByteArray|5b|"; within:50; content:"|2a 20|TABLE1_STRIDE|29 7c 30 29 20 26 20 28|TABLE1_BYTES-1|29|"; distance:0; fast_pattern; content:"|5e 3d 20|probeTable|5b|"; distance:0; content:"|7c 30 5d 7c 30 3b|"; distance:0; reference:url,AP-4605; sid:8000271; rev:1; )
alert tcp any any -> any any (msg:"ZB Spectre.KernelMemory.Leak.JS"; flow:established,from_server; file_data; content:"<script"; nocase; content:"<"; distance:0; nocase; content:".length"; distance:0; nocase; fast_pattern; pcre:"/^\s*?\)\s*?\{\s*(?P<var>[^\s]+)\s*=[^\x5b]+?\x5b\s*(?P=var)\s*?\|\s*?0\s*?\]\s*?\x3b\s*?/Rsi"; content:"^="; distance:0; pcre:"/^\s*[^\s]+\x5b\s*?[^\x5d\x7c]+\x7c\s*?0\s*?\x5d\s*?\x7c\s*?0\s*?\x3b/Rsi"; reference:url,AP-4605; sid:8000272; rev:1;)

#Jan 12, 2018

alert tcp any any -> any any (msg:"FILE-IDENTIFY Portable Executable binary file magic detected"; flow:to_client,established; file_data; content:"MZ"; byte_jump:4,58,relative,little; content:"PE|00 00|"; within:4; distance:-64; flowbits:set,file.exe; flowbits:noalert;  sid:8000273; rev:10;)
alert tcp any any -> any any (msg:"FILE-IDENTIFY Portable Executable download detected"; flow:to_client,established; content:"application/x-msdos-program"; fast_pattern:only; http_header; pcre:"/^Content-Type\x3a[\x20\x09]+application\/x-msdos-program/smiH"; file_data; content:"MZ"; within:2; flowbits:set,file.exe; flowbits:noalert;  sid:8000274; rev:11;)
alert tcp any any -> any any (msg:"FILE-IDENTIFY Portable Executable download detected"; flow:to_client,established; content:"application/octet-stream"; fast_pattern:only; http_header; pcre:"/^Content-Type\x3a[\x20\x09]+application\/octet-stream/smiH"; file_data; content:"MZ"; within:2; flowbits:set,file.exe; flowbits:noalert;   sid:8000275; rev:11;)
alert tcp any any -> any 25 (msg:"FILE-IDENTIFY Portable Executable binary file magic detected"; flow:to_server,established; file_data; content:"MZ"; byte_jump:4,58,relative,little; content:"PE|00 00|"; within:4; distance:-64; flowbits:set,file.exe;   sid:8000276; rev:9;)
alert tcp any any -> any 25 (msg:"FILE-IDENTIFY Portable Executable file attachment detected"; flow:to_server,established; content:".exe"; fast_pattern:only; content:"Content-Disposition: attachment|3B|"; content:"filename="; nocase; pcre:"/filename=[^\n]*\x2eexe/i"; flowbits:set,file.exe; flowbits:noalert;   sid:8000277; rev:11;)
alert tcp any [110,143] -> any any (msg:"FILE-IDENTIFY Portable Executable file attachment detected"; flow:to_client,established; content:".exe"; fast_pattern:only; content:"Content-Disposition: attachment|3B|"; content:"filename="; nocase; pcre:"/filename=[^\n]*\x2eexe/i"; flowbits:set,file.exe; flowbits:noalert;   sid:8000278; rev:10;)
alert tcp any any -> any [80,8080] (msg:"FILE-IDENTIFY Portable Executable binary file download request"; flow:to_server,established; content:".exe"; fast_pattern:only; http_uri; pcre:"/\x2eexe([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.exe; flowbits:noalert;  reference:url,en.wikipedia.org/wiki/.exe;  sid:8000279; rev:23;)
#alert tcp any any -> any any (msg:"ZB Intelx64.KernelMemory.Leak-CVE-2017-5754"; flow:to_client,established; file_data; flowbits:isset,file.exe; content:"|48 8B|"; byte_extract:4,1,array,relative; content:"|48 FF C0 48 89|"; within:10; byte_test:4,=,array,1,relative; content:"|48 83|"; within:20; byte_test:4,=,array,1,relative; content:"|E8|"; within:15; sid:8000280; rev:1;)
#alert tcp any any -> any any (msg:"ZB Intelx64.KernelMemory.Leak-CVE-2017-5754"; flow:to_client,established; file_data; flowbits:isset,file.exe; content:"|68 00 08 00 00 8D 85 F8 F7 FF FF 89 15 CC 5A 40 00 68 FF 00 00 00 50 C7 83 40 1F 00 00 01 00 00|"; fast_pattern:only; sid:8000281; rev:1;)
#alert tcp any any -> any any (msg:"ZB Intelx64.KernelMemory.Leak.JS-CVE-2017-5754"; flow:to_client,established; file_data; content:"x = ((j % 6) - 1) & ~0xFFFF|3B| /* Set x=FFF.FF000"; fast_pattern:only; sid:8000282; rev:1;)
#alert tcp any any -> any any (msg:"ZB Intelx64.KernelMemory.Leak.JS-CVE-2017-5754"; flow:to_client,established; file_data; content:"L2_cache_clear = (BYTE*)VirtualAlloc(0, 256 * 4096"; fast_pattern:only; sid:8000283; rev:1;)
#alert tcp any any -> any any (msg:"ZB Intelx64.KernelMemory.Leak-CVE-2017-5754"; flow:to_client,established; file_data; content:"localJunk ^= probeTable[index|7C|0]|7C|0|3B|"; fast_pattern:only; sid:8000284; rev:1;)
#alert tcp any any -> any any (msg:"ZB Intelx64.KernelMemory.Leak-CVE-2017-5754"; flow:to_client,established; file_data; flowbits:isset,file.exe; content:"|B8 08 00 00 00 48 69 C0 E8 03 00 00 48 8D 0D 79 6F 00 00 48 8B 95 D0 0C 00 00 48 89 14 01|"; fast_pattern:only; sid:8000285; rev:1;)
#alert tcp any any -> any 25 (msg:"ZB Intelx64.KernelMemory.Leak-CVE-2017-5754"; flow:to_server,established; file_data; flowbits:isset,file.exe; content:"|68 00 08 00 00 8D 85 F8 F7 FF FF 89 15 CC 5A 40 00 68 FF 00 00 00 50 C7 83 40 1F 00 00 01 00 00|"; fast_pattern:only; sid:8000286; rev:1;)
#alert tcp any any -> any 25 (msg:"ZB Intelx64.KernelMemory.Leak-CVE-2017-5754"; flow:to_server,established; file_data; content:"x = ((j % 6) - 1) & ~0xFFFF|3B| /* Set x=FFF.FF000"; fast_pattern:only; sid:8000287; rev:1;)
#alert tcp any any -> any 25 (msg:"ZB Intelx64.KernelMemory.Leak-CVE-2017-5754"; flow:to_server,established; file_data; content:"L2_cache_clear = (BYTE*)VirtualAlloc(0, 256 * 4096"; fast_pattern:only;  sid:8000288; rev:1;)
#alert tcp any any -> any 25 (msg:"ZB Intelx64.KernelMemory.Leak-CVE-2017-5754"; flow:to_server,established; file_data; content:"localJunk ^= probeTable[index|7C|0]|7C|0|3B|"; fast_pattern:only; sid:8000289; rev:1;)

#Hunting rule
#alert tcp any any -> any any (msg:"ZB MSSQL.RCE.Attempt"; flow:to_server,established; content:"xp_cmdshell"; fast_pattern:only; sid:8000290; rev:1;)

#Jan 23, 2018
alert tcp any any -> any 445 (msg:"ZB SamSam.Ransomware.SMB-Transfer"; flow:to_server,established; content:"|FF|SMB|A2|"; depth:5; offset:4; content:".stubbin|00|"; fast_pattern:only; sid:8000291; rev:1;)
alert tcp any any -> any 445 (msg:"ZB SamSam.Ransomware.SMB2-Transfer"; flow:to_server,established; content:"|FE|SMB"; depth:4; offset:4; content:"|05 00|"; within:2; distance:8; content:".|00|s|00|t|00|u|00|b|00|b|00|i|00|n|00|"; fast_pattern:only; sid:8000292; rev:1;)
alert tcp any any -> any 445 (msg:"ZB SamSam.Ransomware.SMB-Upload"; flow:to_server,established; content:"|00 00 0A 2C 08 06 16 9A 28|"; content:"|00 00 0A 02 16 9A 28 03 00 00 06 28|"; within:12; distance:1; sid:8000293; rev:1;)

alert tcp any any -> any 80 (msg:"ZB IIS.IntegerOverflow.CVE-2015-1635"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1.1|0d 0a|"; distance:0; content:"|0d 0a|Range: bytes="; distance:0; content:"-18446744073709551615"; distance:0; fast_pattern; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,AP-3138; flowbits:set,IISOverflow; flowbits:noalert; sid:8000104; rev:1; )

alert tcp any 80 -> any any (msg:"ZB IIS.IntegerOverflow.CVE-2015-1635"; flow:to_client,established; content:"HTTP/1.1 416 Requested Range Not Satisfiable|0d 0a|"; fast_pattern; content:!"GET "; depth:4; content:!"POST "; depth:5; reference:url,AP-3138; flowbits:isset,IISOverflow; sid:8000294; rev:1; )

#January 26, 2018 - Dan
#alert udp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"ZB Hide_N_Seek.Botnet.P2P.IoT"; dsize:<17; detection_filter: track by_dst, count 30, seconds 30; sid:8000295; rev:1;)

#January 31, 2018 - Dan
alert tcp any any -> any 80 (msg:"ZB GrandCrab.Ransomware"; flow:to_server,established; urilen:200<>900; content:"GET "; depth:4; content:"/?"; distance:0; content:"==&"; distance:0; content:"==&"; distance:0; content:"==&"; distance:0; content:"== HTTP/1.1|0d 0a|";  distance:0; fast_pattern; sid:8000296; rev:1;)


#Feb 1, 2018 - Dan
alert tcp any any -> any 80 (msg:"ZB Dahua.PasswordLeak.Gen2.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/current_config/passwd HTTP/1."; fast_pattern; distance:0; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,http://us.dahuasecurity.com/en/us/Security-Bulletin_030617.php; reference:url,AP-2596; flowbits:set,Dahua101; flowbits:noalert; sid:8000101; rev:1; )
alert tcp any 80 -> any any (msg:"ZB Dahua.PasswordLeak.Gen2.IoT"; flow:to_client,established; content:!"HTTP/1.1 404"; depth:12; reference:url,AP-2596; flowbits:isset,Dahua101; sid:8000297; rev:1; )
alert tcp any any -> any 80 (msg:"ZB Dahua.PasswordLeak.Gen3.IoT"; flow:to_server,established; content:"GET "; depth:4; content:"/current_config/Account1 HTTP/1."; fast_pattern; distance:0; content:!"|0d 0a|Referer: "; content:!"|0d 0a|Cookie: "; reference:url,http://us.dahuasecurity.com/en/us/Security-Bulletin_030617.php; reference:url,AP-2596; flowbits:set,Dahua102; flowbits:noalert; sid:8000102; rev:1; )
alert tcp any 80 -> any any (msg:"ZB Dahua.PasswordLeak.Gen3.IoT"; flow:to_client,established; content:!"HTTP/1.1 404"; depth:12; reference:url,AP-2596; flowbits:isset,Dahua102; sid:8000298; rev:1; )

#Feb 5, 2018 - Dan
alert tcp any any -> any 80 (msg:"ZB GoAhead.RCE-CVE-2017-17562.IoT"; flow:established,to_server; content:"/cgi-bin/"; depth:60; content:"?LD_PRELOAD=/proc/self/fd/0"; fast_pattern; distance:0; content:" HTTP/1."; distance:0; reference:url,AP-4535; flowbits:set,GoAhead269; flowbits:noalert; sid:8000269; rev:1;)
#08/14/2018 - Update
alert tcp any 80 -> any any (msg:"ZB GoAhead.RCE-CVE-2017-17562.IoT, extract=true"; flow:to_client,established; content:!"HTTP/1.1 404"; depth:12; reference:url,AP-4535; flowbits:isset,GoAhead269; sid:8000299; rev:1;)

#Feb March 9, 2018
#alert tcp any any -> any any (msg:"ZB PowerShell.RemoteAccess"; flow:established,to_server; content:"POST "; depth:5; content:"|0d 0a|User-Agent: Microsoft WinRM Client|0d 0a|"; fast_pattern; sid:8000300; rev:1;)

#Dan Mar 15, 2018
alert tcp any any -> any 80 (msg:"ZB GETH.Bitcoin.Stealer"; flow:established,to_server; content:"POST "; depth:5; content:"|0d 0a|User-Agent: Geth/v"; fast_pattern; distance:0; content:"Content-Type: application/json|0d 0a|"; distance:0; sid:8000301; rev:1;)

#March 20, 2018
#Reporting this event per source once per day
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 80 -> any any (msg:"ZB HTTP_ERROR_Response.Suspicious"; flow:to_client,established; content:"HTTP/1.1 500 Internal Server Error|0d 0a|"; depth:36; flowbits:set,500_error; flowbits:noalert; threshold: type limit, track by_dst, count 1 , seconds 604800 ; sid:8000302; rev:1; )

#March 26, 2018

alert tcp any any -> any [!2049] (msg:"ZB MSSQL-Injection.Suspicious.Error, extract=true"; flow:to_client,established; content:"Microsoft OLE DB Provider for ODBC Drivers error"; depth:50; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000303; rev:1; )
alert tcp any any -> any [!2049] (msg:"ZB MySQL_Syntax_Error.Suspicious.Error, extract=true"; flow:to_client,established; content:"You have an error in your SQL syntax\; check the manual"; depth:70; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000304; rev:1; )
alert tcp any any -> any [!2049] (msg:"ZB MSSQL-Injection.Suspicious.Error, extract=true"; flow:to_client,established; content:"Microsoft SQL Native Client error"; depth:50; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000305; rev:1; )
alert tcp any any -> any [!2049] (msg:"ZB Oracle-Injection.Suspicious.Error, extract=true"; flow:to_client,established; content:"ORA-00933: SQL command not properly ended"; depth:50; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000306; rev:1; )
alert tcp any any -> any [!2049] (msg:"ZB PostgreSQL-Injection.Suspicious.Error, extract=true"; flow:to_client,established; content:"Query failed: ERROR: syntax error at or near"; depth:50; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000307; rev:1; )
alert tcp any any -> any [!2049] (msg:"ZB SQLite3-Injection.Suspicious.Error, extract=true"; flow:to_client,established; content:"SQLite3::query(): Unable to prepare statement:"; nocase; depth:70; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000308; rev:1; )
alert tcp any any -> any [!2049] (msg:"ZB Root-Account.Suspicious.Dump, extract=true"; flow:to_client,established; content:"root:x:0:0:root:/root:/bin/"; depth:200; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000309; rev:1; )
alert tcp any any -> any [!2049] (msg:"ZB FileInclusion.Suspicious.Response, extract=true"; flow:to_client,established; content:": failed to open stream: No such file or directory in "; depth:100; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000310; rev:1; )

#CryptoMining Hunting rules
alert tcp any 80 -> any any (msg:"ZB Coinhive.Mining.Suspicious"; flow:to_client,established; content:"hasWASMSupport"; nocase; content:"forceASMJS"; nocase; threshold: type limit, track by_src, count 1 , seconds 60; sid:8000311; rev:1; )
alert tcp any 80 -> any any (msg:"ZB Coinhive.Mining.Suspicious"; flow:to_client,established; content:"CoinHive.Anonymous("; nocase; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000312; rev:1; )
alert tcp any 80 -> any any (msg:"ZB DeepMiner.Suspicious"; flow:to_client,established; content:"deepMiner.Anonymous("; nocase; threshold: type limit, track by_src, count 1 , seconds 60 ; sid:8000313; rev:1; )

#April 23, 2018
#08/14/2018 - Update
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any ->  any 80 (msg:"ZB Orangework.Kwampirs.Beacon"; flow:to_server,established; content:"GET "; depth:4; content:".php?q=kt"; distance:0; nocase; fast_pattern; content:" HTTP/1."; distance:0; sid:8000316; rev:1; )

#Dan Apr19
alert tcp any any -> any 80 (msg:"ZB Drupalgeddon2.Trigger"; flow: to_server,established; content:"POST"; http_method; content:"markup"; fast_pattern; content: "/user/register"; http_uri; pcre:"/(access_callback|pre_render|lazy_builder|post_render)/i"; flowbits:set,drupalgeddon; flowbits:noalert; sid:8000317; rev:1;)

alert tcp [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any -> any any (msg:"ZB Drupalgeddon2.CVE-2018-7600"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; flowbits:isset,drupalgeddon; sid:8000318; rev:1; )

#Dan Apr24
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB HTTP_ERROR_Generic, extract=true"; flow:to_client,established; flowbits:isset,500_error; pcre:"/Oracle\s*Exception|SQL\s*Exception|password|username|database|root:|overflow|crash|shell|execve\(|eval\(|cmd|\/bin\/sh|netcat|bash_profile|Autoexec|StackTrace/i"; content:!"Recovery database"; content:!"NSC_mc_Ufmfusbd"; content:!"XBDS username error: empty username"; content:!"{\"Message\"\:\"There was an error processing the request.\",\"StackTrace\"\:\"\",\"ExceptionType\"\:\"\"}"; threshold: type limit, track by_dst, count 1 , seconds 604800 ; sid:8000314; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Fujimed.InformationLeak"; flow:to_client,established; flowbits:isset,500_error; content:">>DB.GetDoc com.fujimed.Login."; sid:8000319; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB PACS.InformationLeak"; flow:to_client,established; flowbits:isset,500_error; content:"Cannot open database "; content:"Login failed for user"; distance:0; sid:8000320; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Metasys.BAS.InformationLeak"; flow:to_client,established; flowbits:isset,500_error; content:"SoapException:"; content:"at JohnsonControls.MetasysIII.Security."; distance:0; sid:8000321; rev:1; )

#Dan Apr25
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 80 -> any any (msg:"ZB GE.Ultrasound.InformationLeak"; flow:to_client,established; flowbits:isset,500_error; content:"ExceptionDetail"; content:"sDx.Services.MembershipProvider"; distance:0; sid:8000322; rev:1; )

#Dan May 1
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB Whatismyip.Check.Suspicious"; flow:established,to_server; uricontent:"/automation/n09230945.asp"; sid:8000323; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB Whatismyip.Check.Suspicious.2"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".whatismyip."; within:15; threshold: type limit, track by_dst, count 1 , seconds 604800 ; sid:8000324; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB ShowIP.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".showip."; within:15; sid:8000325; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB Cmyip.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".cmyip."; within:12; sid:8000326; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB Showmyip.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".showmyip."; within:15; sid:8000327; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB IPChicken.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".ipchicken."; within:15; sid:8000328; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB Whatismyipaddress.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".whatismyipaddress."; within:24; sid:8000329; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB IPLocation.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".iplocation."; within:15; sid:8000330; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB PrivateInternet.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".privateinternetaccess."; within:27; sid:8000331; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB What-Is-My-IP.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".my-ip-address."; within:20; sid:8000332; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB MyIPAddress.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".myipaddress.com."; within:22; sid:8000333; rev:1;)
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB MyIPLocation.Check.Suspicious"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|Host\: "; content:".myiplocation."; within:17; sid:8000334; rev:1;)

#Dan May 2nd
alert tcp any any -> any any (msg:"ZB VGo.CGI-BIN.Interface"; flow:established,to_server; content:"GET "; depth:4; content:"/cgi-bin/celia_cmd?"; fast_pattern; sid:8000335; rev:1;)
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"ZB Wget.Traffic.Suspicious"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1.1|0d 0a|"; distance:0; content:"User-Agent: Wget/"; fast_pattern; distance:0;  sid:8000005; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"ZB Curl.Traffic.Suspicious"; flow:to_server,established; content:"GET "; depth:4; content:" HTTP/1.1|0d 0a|"; distance:0; content:"User-Agent: curl/"; fast_pattern; distance:0;  content:!"curl/7.29.0"; sid:8000006; rev:1; )
alert tcp [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"ZB ELF_binary.HTTP_Download.Suspicious, extract=true"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; content:"|0d 0a 0d 0a 7f 45 4c 46|"; distance:0; within:360; sid:8000336; rev:1; )
#alert tcp [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"ZB ELF64_binary.HTTP_Download.Suspicious, extract=true"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; content:"|0d 0a 0d 0a 7f 45 4c 46 02|"; distance:0; within:360; sid:8000336; rev:1; )
alert tcp [!70.160.0.0/11,!167.206.0.0/16,!93.184.215.201/22,!72.246.0.0/15,!209.67.0.0/16,!66.18.32.0/19,!205.185.192.0/19,!204.0.0.0/14,!208.111.128.0/18,!74.125.0.0/16,!184.24.0.0/13,!96.16.0.0/15,!8.224.0.0/11,!69.164.0.0/18,!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16,!23.32.0.0/11,!23.64.0.0/16,!209.85.128.0/17,!198.181.234.0/23,!198.181.233.0/24,!192.229.128.0/17,!72.21.80.0/20,!13.64.0.0/11,!13.96.0.0/13,!13.104.0.0/14,!173.194.0.0/16,!23.192.0.0/11,!125.0.0.0/8,!184.50.0.0/15,!208.184.0.0/15,!23.32.0.0/11,!23.64.0.0/14,!165.254.0.0/16,!23.72.0.0/13,!172.217.0.0/16,!104.64.0.0/10,!90.84.51.0/24,!67.24.0.0/13,!184.84.0.0/14,!65.128.0.0/11] 80 -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg: "ZB MZ_Binary.Download.Suspicious, extract=true"; flow:to_client,established; content:"MZ"; isdataat: 76,relative; content:"This program cannot be run in DOS mode."; distance: 0; isdataat: 10,relative; content:"PE"; distance: 0; reference:url,AP-3462; sid:8000338; rev:1; )
alert tcp [!167.206.0.0/16,!93.184.215.201/22,!72.246.0.0/15,!209.67.0.0/16,!66.18.32.0/19,!205.185.192.0/19,!204.0.0.0/14,!208.111.128.0/18,!74.125.0.0/16,!184.24.0.0/13,!96.16.0.0/15,!8.224.0.0/11,!69.164.0.0/18,!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16,!23.32.0.0/11,!23.64.0.0/16,!209.85.128.0/17,!198.181.234.0/23,!198.181.233.0/24,!192.229.128.0/17,!72.21.80.0/20,!13.64.0.0/11,!13.96.0.0/13,!13.104.0.0/14,!173.194.0.0/16,!23.192.0.0/11,!125.0.0.0/8,!184.50.0.0/15,!208.184.0.0/15,!23.32.0.0/11,!23.64.0.0/14,!165.254.0.0/16,!23.72.0.0/13,!172.217.0.0/16,!104.64.0.0/10,!90.84.51.0/24,!67.24.0.0/13,!184.84.0.0/14,!65.128.0.0/11] 80 -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg: "ZB MZ_Delphi_Binary.Download.Suspicious, extract=true"; flow:to_client,established; content:"MZ"; isdataat: 76,relative; content:"This program must be run under Win32"; distance: 0; isdataat: 10,relative; content:"PE"; distance: 0; reference:url,AP-3462; sid:8000186; rev:1; )

#May 21, 2018 - Dan R
#alert udp any 161 -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"ZB Enumeration_SNMP"; flow:to_client; content:"|2b 06 01 02 01 01|"; within:42; content:!"|2B 06 01 02 01 01 02|"; detection_filter:track by_dst,count 5,seconds 5; sid:8000400; rev:1;)
alert udp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 161 (msg:"ZB Login_BruteForce_SNMP"; flow:to_server; content:"|2b 06 01 02 01 01 01 00|"; within:42; detection_filter:track by_src,count 200,seconds 30; sid:8000340; rev:1;)

#May 31, 2018 - Yes, in my birthday writing rules!!!!! 
alert tcp any any -> any 80 (msg:"ZB eDesk.PHI.Leak, extract=true "; flow:established,to_server; content:"POST "; depth:5; content:"/secEmpFinder.asp?field=Employee_ID HTTP/1.1|0d 0a|"; distance:0; fast_pattern; sid:8000341; rev:3;)

alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] $HTTP_PORTS (msg:"ZB TOR_Traffic.Suspicious"; flow:established,to_server; content:"Host: "; http_header; content:".onion."; within:10; distance:5; sid:8000342; rev:1;)

#June 7, 2018 - DR
alert tcp any any -> any 88 (msg:"ZB Foscam.Camera.File_Deletion_Attempt-CVE-2018-6830, extract=true"; flow:established,to_server; content:"GET "; depth:4; content:"/snapPic/../../"; distance:0; fast_pattern; sid:8000343; rev:1;)
alert tcp any any -> any 88 (msg:"ZB Foscam.Camera.StackOverflow-CVE-2018-6832, extract=true"; flow:established,to_server; content:"GET "; depth:4; content:"/cgi-bin/CGIProxy.fcgi?cmd=getSWFlag"; distance:0; fast_pattern; isdataat:350,relative; sid:8000344; rev:1;)
alert tcp any any -> any 88 (msg:"ZB Foscam.Camera.ShellCommandInjection-CVE-2018-6831, extract=true"; flow:established,to_server; content:"GET "; depth:4; content:"/cgi-bin/CGIProxy.fcgi?cmd=setSystemTime"; distance:0; fast_pattern; content:"&ntpServer="; distance:0; sid:8000345; rev:1;)
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB CareStream.StackTrace, extract=true"; flow:to_client,established; flowbits:isset,500_error; content:"OracleException"; content:"Kodak.RISr2."; sid:8000346; rev:1; )

#Jun 9, 2018 - DR
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Syngo.StackTrace, extract=true"; flow:to_client,established; flowbits:isset,500_error; content:"<StackTrace>"; content:"at sDx.Services.MembershipProvider."; fast_pattern; distance:0; sid:8000347; rev:1; )

#Jul 2, 2018 - DR
alert tcp any any -> any any (msg:"ZB CPUMiner-Multi.Beacon, extract=true"; flow:to_server,established; content:"|22|method|22|"; nocase; content:"|22|agent|22|"; nocase; content:"|22|cpuminer-multi"; fast_pattern:only;  reference:url,github.com/OhGodAPet/cpuminer-multi; threshold: type limit, track by_src, count 1 , seconds 86400; sid:8000348; rev:1;)

#July 17, 2018 - DR
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB PeerVue.StackTrace, extract=true"; flow:to_client,established; flowbits:isset,500_error; content:"at PeerVueService."; fast_pattern; content:"exception stack trace"; distance:0; sid:8000349; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB CBORD.StackTrace, extract=true"; flow:to_client,established; flowbits:isset,500_error; content:"Stack Trace"; content:"[CBORDException"; fast_pattern; distance:0; sid:8000350; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Clairvia.StackTrace, extract=true"; flow:to_client,established; flowbits:isset,500_error; content:"StackTrace"; content:"at StaffingFramework.BusinessLibrary."; fast_pattern; distance:0; sid:8000351; rev:1; )

#July 19, 2018 - DR
alert tcp any any -> any $HTTP_PORTS (msg:"ZB TeleTracking.PatientCare.Identification"; flow:to_server,established; content:"GET "; depth:4; content:"/XT/"; distance:0; fast_pattern; content:"PatientTrackingPortal/"; distance:0; content:"|0d 0a|x-requested-with: XMLHttpRequest|0d 0a|"; reference:url,www.teletracking.com; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000352; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Clairvia.PatientCare.Identification, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"/ClairviaWeb/"; fast_pattern; distance:0; content:".asmx/"; distance:0; threshold: type limit, track by_dst, count 1 , seconds 86400;sid:8000353; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Syngo.PatientCare.Identification, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"/sDPortal/WSS"; distance:0; fast_pattern; content:".svc HTTP/1.1"; distance:0; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000354; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB PeerVue.PatientCare.Identification, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"/peerVue/"; distance:0; fast_pattern; content:".asmx HTTP/1.1"; distance:0; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000355; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Carestream.VueRIS.Radiology.Identification, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"|0d 0a|SOAPAction: \"http://Kodak.RISr2.WebServices/"; distance:0; fast_pattern; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000356; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Lawson.PatientCare.Identification, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"/sso/SSOServlet?"; distance:0; fast_pattern; content:"|0d 0a|_ssoClientType: MSXML|0d 0a|"; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000357; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB PatientCare.Gen.Identification, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"/imagecast/ptLookup/DoPatientLookup.asp?"; distance:0; fast_pattern; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000358; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB PatientCare.Gen.Identification, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"/eHealthIDN/Server/XMLServicesHandler.ashx"; distance:0; fast_pattern; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000359; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB RealView.PACS.Identification, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"/RealView/Controllers/Case.ashx "; distance:0; fast_pattern; reference:url,http://realviewimaging.com; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000360; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB RadPortal.Gen.Identification, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"/RadPortal/"; distance:0; fast_pattern; content:".axd?"; distance:0; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000361; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Prosolv.PACS.Identification, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"Prosolv.WebLab/"; distance:0; fast_pattern; content:".aspx?"; distance:0; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000362; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Philips.PACS.Identification, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"|0d 0a|User-Agent: Philips.Pii.Transport.Http.Win32WinHttpClientTransportConnection/1.0|0d 0a|"; distance:0; fast_pattern; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000363; rev:1; )

alert tcp any any -> any 445 (msg:"ZB SMB.FileTransfer.Gen, extract=true "; flow:to_server,established; content:"|FF|SMB|2f 00 00 00 00|"; depth:9; offset:4; content:"|4D 5A 90 00 03 00 00 00|"; within:64; sid:8000364; rev:1;)

#July 24 - DR
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Apache-Tomcat.InformationDisclosure-CVE-2018-8037, extract=true"; flow:to_client,established; content:"java.nio.BufferOverflowException"; threshold: type limit, track by_src, count 1 , seconds 86400; reference:url,https://www.alphabot.com/security/blog/2018/java/Apache-Tomcat-user-session-mix-up-and-DoS.html; sid:8000365; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Apache-Tomcat.NullPointerException, extract=true"; flow:to_client,established; content:"java.lang.NullPointerException"; fast_pattern; content:"org.apache.coyote.http"; distance:0; threshold: type limit, track by_src, count 1 , seconds 86400; sid:8000366; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Apache-Struts-CVE-2017-5638, extract=true"; flow:to_client,established; content:"org.apache.commons.fileupload.FileUploadBase$InvalidContentTypeException:"; fast_pattern; threshold: type limit, track by_src, count 1 , seconds 86400; reference:url,https://blog.gdssecurity.com/labs/2017/3/27/an-analysis-of-cve-2017-5638.html; sid:8000367; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Apache-Struts-CVE-2017-9805, extract=true"; flow:to_client,established; content:"java.lang.String cannot be cast to java.security.Provider$Service"; fast_pattern; threshold: type limit, track by_src, count 1 , seconds 86400; reference:url,http://robwillis.info/2017/09/exploiting-apache-struts-cve-2017-9805/; sid:8000368; rev:1; )
#alert tcp any 445 -> any any (msg:"ZB SMB-CVE-2017-0144, extract=true "; flow:to_client,established; content:"|FF|SMB|25 05 02 00 C0|"; depth:9; offset:4; reference:url,https://www.exploit-db.com/exploits/42315/; sid:8000369; rev:1;)
alert tcp any any -> any 445 (msg:"ZB SMB.CreateService.Remote, extract=true "; flow:to_server,established; content:"|FF|SMB|25 00 00 00 00|"; depth:9; offset:4; content:"|13 00 00 00 00 00 e8 c2 47 29 0a 97 08 46 bd 69 39 24 9a 17 a9 ab 00 00 00 00 00 00 00 00|";within:145; threshold: type limit, track by_dst, count 1 , seconds 86400; sid:8000370; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"ZB McKesson.OneContent.Identification, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"/mpf/"; distance:0; content:"|0d 0a|Cookie: OneContentMPF="; fast_pattern; threshold: type limit, track by_dst, count 1 , seconds 86400; rev:1; sid:8000371; )

#July 25 - DR
#08/14/2018 Update 
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"ZB BasicAuth.Base64.Password-Unencrypted"; flow:established,to_server; content:"|0d 0a|Authorization|3a 20|Basic"; nocase; content:!"YW5vbnltb3VzOg=="; within:32; pcre:"/(?:[A-Za-z0-9+\/]{4}\\n?)*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)/"; reference:url,doc.emergingthreats.net/bin/view/Main/2006380; threshold: type limit, track by_dst, count 1 , seconds 1296000; sid:8000372; rev:10;)
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any any (msg:"ZB Base64.Beacon.Gen, extract=true"; pcre:"/(?:[A-Za-z0-9+/]{4}){2,}(?:[A-Za-z0-9+/]{2}[AEIMQUYcgkosw048]=|[A-Za-z0-9+/][AQgw]==)/"; threshold: type limit, track by_dst, count 1 , seconds 86400; sid: 8000373;)

alert tcp any any -> any $HTTP_PORTS (msg:"ZB HomeMatic.Zentrale.CCU2.RCE-CVE, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"/api/backup/logout.cgi?sid="; fast_pattern; distance:0; content:"\")\;"; distance:0; reference:url,https://www.exploit-db.com/exploits/45052/; sid: 8000374;)
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Apache.CouchDB.RCE-CVE-2017-12636, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"/_config/query_servers/cmd"; fast_pattern; distance:0; reference:url,https://www.exploit-db.com/exploits/44913/; sid: 8000375;)
alert udp any any -> any $HTTP_PORTS (msg:"ZB Sony.IPLELA.Camera.UDP.RCE-CVE-2018-3937, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"/command/main.cgi"; fast_pattern; distance:0; content:"|0d 0a 0d 0a|measurement=bitrate,client,"; distance:0; content:",udp,123"; reference:url,https://www.talosintelligence.com/reports/TALOS-2018-0604; sid: 8000376;)
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Sony.IPLELA.Camera.TCP.RCE-CVE-2018-3937, extract=true"; flow:to_server,established; content:"POST "; depth:5; content:"/command/main.cgi"; fast_pattern; distance:0; content:"|0d 0a 0d 0a|measurement=bitrate,client,"; distance:0; content:",tcp,123"; reference:url,https://www.talosintelligence.com/reports/TALOS-2018-0604; sid: 8000377;)

#July 30 - DR
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Nuance.Radiology.StackTrace, extract=true"; flow:to_client,established; flowbits:isset,500_error; content:">Nuance.Radiology.Services.RasApplicationException:"; fast_pattern; sid:8000378; rev:1; )
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB Hospira.InternalError.Gen, extract=true"; flow:to_client,established; flowbits:isset,500_error; content:"|0d 0a|Hospira-Versions:"; fast_pattern; sid:8000379; rev:1; )

#Aug 14, 2018

alert tcp any any -> any $HTTP_PORTS (msg:"ZB Hikvision.AuthBypass.Attempt.Gen, extract=true"; flow:to_server,established; content:"/Security/users?auth="; fast_pattern; http_uri; content:" HTTP/1."; distance:0; reference:url,AP-3794; sid:8000380; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Hikvision.AuthBypass.Attempt.Gen, extract=true"; flow:to_server,established; content:"/onvif-http/snapshot?auth="; fast_pattern; http_uri; content:" HTTP/1."; distance:0; reference:url,AP-3794; sid:8000381; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB Hikvision.AuthBypass.Attempt.Gen, extract=true"; flow:to_server,established; content:"/System/configurationFile?auth="; fast_pattern; http_uri; content:" HTTP/1."; distance:0; reference:url,AP-3794; sid:8000382; rev:1; )
alert tcp any any -> any any (msg:"ZB IFS.Bypass.Gen, extract=true"; flow:to_server,established; content:"GET "; depth:4; content:"${IFS}"; http_uri; distance:0; fast_pattern; sid:8000383; rev:1; )
alert tcp any any -> any [23,139,445,21,80] (msg:"ZB BusyBox.Gen.IoT, extract=true"; flow:to_server,established; content:"/bin/busybox "; depth:30; sid: 8000384; rev:1;)
alert tcp any any -> any any (msg:"ZB BusyBox.Telnet.Gen, extract=true"; flow:to_server,established; content:"busybox telnetd -p"; depth:30; reference:url,isc.sans.edu/diary/21833; sid:8000385; rev:1;)

alert tcp any any -> any [23,21,25,80,139,445] (msg:"ZB Linux.CommandInjection.Gen, extract=true "; content:"sh -c "; depth:30; reference:url,AP-3138; sid:8000386; rev:1;)
alert tcp any any -> any [23,21,25,80,139,445] (msg:"ZB Windows.CommandInjection.Gen, extract=true "; content:"cmd.exe /c "; depth:30; reference:url,AP-3138; sid:8000387; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"ZB HUAWEI-HG532e.RemoteExecution.IoT.Gen, extract=true"; flow:established,to_server; content:"POST "; depth:5; content:"/ctrlt/DeviceUpgrade_1 "; fast_pattern; content:"HTTP/1."; distance:0; reference:url,AP-4355; sid:8000388; rev:1;)

alert tcp any any -> any $HTTP_PORTS (msg:"ZB DirTraversal.Gen"; flow:established,to_server; content:"GET "; depth:4; content:"../../../";  fast_pattern; distance:0; content:" HTTP/1."; distance:0; flowbits:set,DirTraversal; flowbits:noalert; sid:8000390; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"ZB DirectoryTraversal.Gen, extract=true"; flow:to_client,established; content:!"HTTP/1.1 400 Bad"; depth:16; content:!"404 Not Found"; content:!"HTTP/1.1 404"; depth:12; flowbits:isset,DirTraversal; threshold: type limit, track by_dst, count 1 , seconds 1209600; sid:8000391; rev:1;)

alert tcp any any -> any any (msg:"ZB Foscam.Camera.ShellCommandInjection.Gen, extract=true"; flow:established,to_server; content:"GET "; depth:4; content:"/cgi-bin/CGIProxy.fcgi?cmd="; distance:0; fast_pattern; sid:8000392; rev:1;)

#Aug 23, 2018
#alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS -> any any (msg:"ZB HTTP_Service_Unavailable.Suspicious"; flow:to_client,established;  content:"HTTP/1.1 503 Service Unavailable|0d 0a|"; depth:34; threshold: type limit, track by_dst, count 1 , seconds 300; sid:8000393; rev:1; )
alert tcp any any -> any $HTTP_PORTS (msg:"ZB BabyMonitors.Beacon, extract=true"; flow:established,to_server; content:"GET "; depth:4; content:"|0d 0a|User-Agent: Baby|25 32 30|Monitor";  fast_pattern; distance:0; content:" HTTP/1."; distance:0; threshold: type limit, track by_src, count 1 , seconds 3600; sid:8000394; rev:1;)

#2018-08-27, added by jxia

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB SSL 3.0 Warning Alert Message"; flow:to_client,established; content:"|15 03 00 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000395; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB SSL 3.0 Warning Alert Message"; flow:to_server,established; content:"|15 03 00 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000396; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB TLS 1.0 Warning Alert Message"; flow:to_client,established; content:"|15 03 01 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000397; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB TLS 1.0 Warning Alert Message"; flow:to_server,established; content:"|15 03 01 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000398; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB TLS 1.1 Warning Alert Message"; flow:to_client,established; content:"|15 03 02 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000399; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB TLS 1.1 Warning Alert Message"; flow:to_server,established; content:"|15 03 02 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000400; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB TLS 1.2 Warning Alert Message"; flow:to_client,established; content:"|15 03 03 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000401; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB TLS 1.2 Warning Alert Message"; flow:to_server,established; content:"|15 03 03 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000402; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB TLS 1.3 Warning Alert Message"; flow:to_client,established; content:"|15 03 04 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000403; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB TLS 1.3 Warning Alert Message"; flow:to_server,established; content:"|15 03 04 00 02 01|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000404; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB SSL 3.0 Fatal Alert Message"; flow:to_client,established; content:"|15 03 00 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000405; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB SSL 3.0 Fatal Alert Message"; flow:to_server,established; content:"|15 03 00 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000406; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB TLS 1.0 Fatal Alert Message"; flow:to_client,established; content:"|15 03 01 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000407; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB TLS 1.0 Fatal Alert Message"; flow:to_server,established; content:"|15 03 01 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000408; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB TLS 1.1 Fatal Alert Message"; flow:to_client,established; content:"|15 03 02 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000409; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB TLS 1.1 Fatal Alert Message"; flow:to_server,established; content:"|15 03 02 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000410; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB TLS 1.2 Fatal Alert Message"; flow:to_client,established; content:"|15 03 03 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000411; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB TLS 1.2 Fatal Alert Message"; flow:to_server,established; content:"|15 03 03 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000412; rev:1;)

alert tcp any [21,25,443,465,636,992,993,995,2484] -> any any (msg:"ZB TLS 1.3 Fatal Alert Message"; flow:to_client,established; content:"|15 03 04 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000413; rev:1;)
alert tcp any any -> any [21,25,443,465,636,992,993,995,2484] (msg:"ZB TLS 1.3 Fatal Alert Message"; flow:to_server,established; content:"|15 03 04 00 02 02|"; threshold:type limit, track by_src, count 1 , seconds 36000; sid:8000414; rev:1;)

#Aug 27, 2018 - Dan R.
alert tcp any any -> any $HTTP_PORTS (msg:"ZB PasswordLeak.Gen_"; flow:to_server,established; content:"GET "; depth:4; content:"/etc/passwd"; http_uri; content:" HTTP/1."; distance:0; reference:url,AP-2596; flowbits:set,PassGen; flowbits:noalert; sid:8000389; rev:1; )
alert tcp any $HTTP_PORTS -> any any (msg:"ZB PasswordLeak.Gen, extract=true"; flow:to_client,established; content:"HTTP/1.1 200 OK|0d 0a|"; http_header; fast_pattern; flowbits:isset,PassGen;  sid:8000415; rev:1;)

##### common rules end




##### research rules start

#Dan May 15, 2018
alert tcp any any -> any $HTTP_PORTS (msg:"POLICY-OTHER TRENDnet IP Camera anonymous access attempt"; flow:to_server,established; content:"/anony/"; fast_pattern:only; http_uri; pcre:"/\/anony\/(jpgview\.htm|mjpeg\.cgi|view2\.cgi|mjpg\.cgi)/Ui"; reference:url,console-cowboys.blogspot.com/2012/01/trendnet-cameras-i-always-feel-like.html; reference:url,www.trendnet.com/press/view.asp?id=1958; reference:url,www.wired.com/threatlevel/2012/02/home-cameras-exposed/; sid:21267; rev:4;)
alert tcp any any -> any $HTTP_PORTS (msg:"POLICY-OTHER Vicon Security and Infinova IP cameras IP filer state change"; flow:to_server,established; content:"/form/formChangeFirewallState"; fast_pattern:only; http_uri; content:"state="; http_client_body;  reference:url,github.com/mcw0/PoC#infinova-rce-authenticated;  sid:45311; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-OTHER D-Link IP Cameras access the ASCII video stream via image luminance"; flow:to_server,established; content:"/md/lums.cgi"; fast_pattern:only; http_uri; reference:cve,2013-1601; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; sid:29795; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-OTHER D-Link IP Cameras access to the video stream via HTTP"; flow:to_server,established; content:"/upnp/asf-mp4.asf"; fast_pattern:only; http_uri; reference:cve,2013-1600; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; sid:29794; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-OTHER D-Link IP Cameras execution of commands from administration web interface"; flow:to_server,established; content:"/cgi-bin/rtpd.cgi|3F|"; fast_pattern:only; http_uri; urilen:>18; reference:cve,2013-1599; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; sid:29793; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Sony IPELA IP Cameras prima-factory.cgi telnet backdoor access attempt"; flow:to_server,established; content:"/command/prima-factory.cgi"; fast_pattern:only; http_uri; content:"Telnet="; nocase; http_uri; reference:url,www.pro.sony.eu/pro/lang/en/eu/article/sony-new-firmware-for-network-cameras; sid:40994; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP MVPower DVR Shell arbitrary command execution attempt"; flow:to_server,established; content:"/shell?"; fast_pattern:only; http_uri; reference:url,www.pentestpartners.com/blog/pwning-cctv-cameras/; sid:42857; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Faleemi IP Cameras information disclosure attempt"; flow:to_server,established; content:"/hy-cgi/"; depth:8; nocase; http_uri; content:".cgi"; nocase; http_uri; content:"cmd="; nocase; pcre:"/[?&]cmd=(get|check)/i"; reference:url,medium.com/iotsploit/faleemi-fsc-880-multiple-security-vulnerabilities-ed1d132c2cce; sid:44497; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Faleemi IP Cameras ftp.cgi command injection attempt"; flow:to_server,established; content:"/hy-cgi/ftp.cgi"; fast_pattern:only; http_uri; content:"server"; nocase; http_client_body; pcre:"/(^|&)ft(\x5f|%5f)server=[^&]*?([\x60\x3b\x7c]|[\x3c\x3e\x24]\x28|%60|%3b|%7c|%26|%3c%28|%3e%28|%24%28)/Pim"; reference:url,medium.com/iotsploit/faleemi-fsc-880-multiple-security-vulnerabilities-ed1d132c2cce; sid:44496; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Faleemi IP Cameras ftp.cgi command injection attempt"; flow:to_server,established; content:"/hy-cgi/ftp.cgi"; fast_pattern:only; http_uri; content:"ft_server="; nocase; http_uri; pcre:"/[?&]ft_server=[^&]*?([\x60\x3b\x7c]|[\x3c\x3e\x24]\x28)/Ui"; reference:url,medium.com/iotsploit/faleemi-fsc-880-multiple-security-vulnerabilities-ed1d132c2cce; sid:44495; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Faleemi IP Cameras ftp.cgi command injection attempt"; flow:to_server,established; content:"/hy-cgi/ftp.cgi"; fast_pattern:only; http_uri; content:"ft_server="; nocase; http_uri; content:"%26"; http_raw_uri; pcre:"/[?&]ft(\x5f|%5f)server=[^&]*?%26/Ii"; reference:url,medium.com/iotsploit/faleemi-fsc-880-multiple-security-vulnerabilities-ed1d132c2cce; sid:44494; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Faleemi IP Cameras ONVIF device_service SQL injection attempt"; flow:to_server,established; content:"/onvif/device_service"; fast_pattern:only; http_uri; content:"<Security"; nocase; http_client_body; content:"<Username"; nocase; http_client_body; pcre:"/<Username[^>]*>[^<]*([\x27\x22\x3b\x23]|\x2f\x2a|\x2d\x2d)/Pi"; reference:cve,2017-14743; reference:url,medium.com/iotsploit/faleemi-fsc-880-multiple-security-vulnerabilities-ed1d132c2cce; sid:44493; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Zavio IP Cameras command injection attempt"; flow:to_server,established; content:"/cgi-bin/admin/param"; fast_pattern:only; http_uri; content:"General"; nocase; http_client_body; pcre:"/(^|&)General(\x2e|%2e)Time(\x2e|%2e)NTP(\x2e|%2e)Server=[^&]*?([\x60\x3b\x7c]|[\x3c\x3e\x24]\x28|%60|%3b|%7c|%26|%3c%28|%3e%28|%24%28)/Pim"; reference:bugtraq,60188; reference:cve,2013-2570; reference:url,www.coresecurity.com/advisories/zavio-ip-cameras-multiple-vulnerabilities; sid:45197; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Zavio IP Cameras command injection attempt"; flow:to_server,established; content:"/cgi-bin/admin/param"; nocase; http_uri; content:"General.Time.NTP.Server="; fast_pattern:only; http_uri; content:"%26"; http_raw_uri; pcre:"/[?&]General(\x2e|%2e)Time(\x2e|%2e)NTP(\x2e|%2e)Server=[^&]*?%26/Ii"; reference:bugtraq,60188; reference:cve,2013-2570; reference:url,www.coresecurity.com/advisories/zavio-ip-cameras-multiple-vulnerabilities; sid:45196; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Zavio IP Cameras command injection attempt"; flow:to_server,established; content:"/cgi-bin/admin/param"; nocase; http_uri; content:"General.Time.NTP.Server="; fast_pattern:only; http_uri; pcre:"/[?&]General\x2eTime\x2eNTP\x2eServer=[^&]*?([\x60\x3b\x7c]|[\x3c\x3e\x24]\x28)/Ui"; reference:bugtraq,60188; reference:cve,2013-2570; reference:url,www.coresecurity.com/advisories/zavio-ip-cameras-multiple-vulnerabilities; sid:45195; rev:1;)
alert tcp any any -> any any (msg:"SERVER-WEBAPP Multiple IP cameras format string exploitation attempt"; flow:to_server,established; content:"/Maintain/upgrade.asp"; nocase; content:"ID"; within:100; nocase; content:"%"; within:25; reference:url,seclists.org/fulldisclosure/2017/Dec/55; sid:45242; rev:1;)
alert tcp any any -> any any (msg:"SERVER-WEBAPP Multiple IP cameras format string exploitation attempt"; flow:to_server,established; content:"/main/index.asp"; nocase; content:"ID"; within:100; nocase; content:"%"; within:25; reference:url,seclists.org/fulldisclosure/2017/Dec/55; sid:45241; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Vivotek IP Cameras remote stack buffer overflow attempt"; flow:to_server,established; content:"/cgi-bin/admin/upgrade.cgi"; fast_pattern:only; http_uri; content:"Content-Length:"; nocase; http_header; pcre:"/Content-Length:[^\x0d]{40}/Hi"; reference:url,download.vivotek.com/downloadfile/support/cyber-security/vivotek-cyber-security-advisory-remote-stack-overflow-of-web-server.pdf; sid:45261; rev:2;)
alert tcp any 6780 -> any any (msg:"SERVER-OTHER Siemens Desigo Insight information disclosure attempt "; flow:to_client,established; content:"|0D 03 00 00|"; depth:4; content:"|5A|"; within:1; distance:3; content:"|00|ools-"; distance:0; content:"|00|SYSTEM|00|"; within:12; reference:url,www.buildingtechnologies.siemens.com/bt/global/en/buildingautomation-hvac/buildingautomation/building-automation-and-control-system-europe-desigo/management-station/pages/managementstation.aspx; sid:35910; rev:4;)
alert tcp any any -> any 6780 (msg:"SERVER-OTHER Siemens Desigo Insight buffer overflow attempt "; flow:to_server,established; dsize:32; content:"|0D 03 00 00|"; depth:4; content:"|81|"; within:1; distance:3; byte_test:4,>,0x100,0,relative; pcre:"/^.{12}[^\x00\x40\xff]{20}$/"; reference:url,www.buildingtechnologies.siemens.com/bt/global/en/buildingautomation-hvac/buildingautomation/building-automation-and-control-system-europe-desigo/management-station/pages/managementstation.aspx; sid:35909; rev:4;)
alert tcp any any -> any $HTTP_PORTS (msg:"SERVER-WEBAPP Siemens IP-Camera credential disclosure attempt, extract=true"; flow:to_server,established; content:"/cgi-bin/readfile.cgi"; fast_pattern:only; http_uri; content:"query=ADMINID"; nocase; http_uri; reference:url,www.exploit-db.com/exploits/40260/; sid:39930; rev:2;)
alert tcp any $HTTP_PORTS -> any any (msg:"MALWARE-CNC Win.Trojan.Cerber variant inbound connection attempt"; flow:to_client,established; content:"Content-Type|3A 20|application/vnd.ms-excel"; fast_pattern:only; http_header; file_data; content:"MZ|90 00|"; depth:4; reference:url,isc.sans.edu/forums/diary/Blank+Slate+malspam+still+pushing+Cerber+ransomware/22215/; sid:42421; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Jaff ransomware outbound connection"; flow:to_server,established; urilen:7; content:"/77g643"; fast_pattern:only; http_uri;  sid:42899; rev:2;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Win.Dropper.Agent ransomware downloader outbound connection detected"; flow:to_server,established; urilen:<19; content:"/read.php?f="; fast_pattern:only; http_uri; pcre:"/f=(\d{1,3}|\d\.(jpg|dat|exe))$/Ui";  reference:url,virustotal.com/en/file/4b6536616daaede6291ac779951e3bcc1819c75c0bc77704e0219ab0245aca19/analysis/; sid:43477; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Win.Dropper.Agent ransomware downloader outbound connection detected"; flow:to_server,established; urilen:<19; content:"/admin.php?f="; fast_pattern:only; http_uri; pcre:"/f=(\d{1,3}|\d\.(jpg|dat|exe))$/Ui"; reference:url,virustotal.com/en/file/f2841ad7f1b870222ea46b00e1cef07f828af189c15ce270d8a2ec58c86ce8e7/analysis/; sid:43476; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"MALWARE-CNC Win.Trojan.Paradise ransomware inbound executable"; flow:to_client,established; file_data; content:"F|00|i|00|l|00|e|00|s|00|.|00|t|00|x|00|t|00|"; content:"F|00|a|00|i|00|l|00|e|00|d|00|.|00|t|00|x|00|t|00|"; content:"/|00|#|00|D|00|E|00|C|00|R|00|Y|00|P|00|T|00| |00|M|00|Y|00| |00|F|00|I|00|L|00|E|00|S|00|#|00|.|00|t|00|x|00|t|00|"; fast_pattern:only; reference:url,virustotal.com/en/file/82cfb70e00f357065b68861e71f04b0af33d77fb63e72997b81c3c0402bf5c80/analysis/; sid:44366; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Paradise ransomware outbound post"; flow:to_server,established; content:"/api/Encrypted.php"; fast_pattern:only; http_uri; content:"computer_name="; http_client_body; content:"decryption_info="; http_client_body; reference:url,virustotal.com/en/file/82cfb70e00f357065b68861e71f04b0af33d77fb63e72997b81c3c0402bf5c80/analysis/; sid:44365; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"MALWARE-CNC Win.Trojan.Reyptson ransomware download"; flow:to_client,established; file_data; flowbits:isset,file.exe; content:"Reyptson"; fast_pattern:only; content:"rthaergaerhaerg"; content:"tsrtjsrtghsrth"; content:"srtysrtusrtyg"; reference:url,www.virustotal.com/en/file/e6d549543863cd3eb7d92436739a66da4b2cc1a9d40267c4bb2b2fa50bf42f41/analysis/; sid:44760; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Spider variant download attempt detected"; flow:to_server,established; content:"/javascript-enc-"; fast_pattern:only; http_uri; pcre:"/javascript-enc-\d{1,2}-\d{1,2}-\d{1,2}\.js/Ui"; reference:url,www.bleepingcomputer.com/news/security/file-spider-ransomware-targeting-the-balkans-with-malspam/; sid:45252; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Spider variant download attempt detected"; flow:to_server,established; content:"/javascript-dec-"; fast_pattern:only; http_uri; pcre:"/javascript-dec-\d{1,2}-\d{1,2}-\d{1,2}\.js/Ui"; reference:url,www.bleepingcomputer.com/news/security/file-spider-ransomware-targeting-the-balkans-with-malspam/; sid:45251; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"MALWARE-CNC Win.Trojan.Velso ransomware download"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|5C|get_my_files.txt"; fast_pattern:only; content:"Velso"; reference:url,www.virustotal.com/en/file/4c8cf7ce3836edceb540edeccae97ef182331f6ed93e678d2e33105d01e809bf/analysis/; sid:45551; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"MALWARE-OTHER Mac OSX FBI ransomware"; flow:to_client,established; file_data; content:"<iframe src=|22|YOUR|25|20BROWSER|25|20HAS|25|20BEEN|25|20LOCKED"; fast_pattern:only; reference:url,blog.malwarebytes.org/intelligence/2013/07/fbi-ransomware-now-targeting-apples-mac-os-x-users/; sid:27246; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-OTHER Win.Trojan.Nemucod file download"; flow:to_server,established; content:"/counter/?"; depth:10; fast_pattern; nocase; http_uri; content:"="; within:3; http_uri; content:"&"; distance:33; http_uri; content:"="; within:4; http_uri; content:!"Referer|3A|"; nocase; http_header; pcre:"/^\/counter\/\?[ai]d?\x3D/iU"; reference:url,virustotal.com/en/file/ba5f5f144f1d1dc555f7abef1b55a44d9bc815f51398a849145aadc7ee285411/analysis/; reference:url,www.bleepingcomputer.com/news/security/decryptor-released-for-the-nemucod-trojans-crypted-ransomware/; sid:44078; rev:2;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"MALWARE-OTHER Win.Ransomware.Thanatos ransomware inbound download attempt"; flow:to_client; flowbits:isset,file.exe; file_data; content:"Release|5C|Thanatos.pdb"; fast_pattern:only; reference:url,www.virustotal.com/#/file/fe1eafb8e31a84c14ad5638d5fd15ab18505efe4f1becaa36eb0c1d75cd1d5a9; sid:45817; rev:1;)

alert tcp any $FILE_DATA_PORTS -> any any (msg:"MALWARE-OTHER Win.Ransomware.Apocalypse download attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|8A 0D 40 30 40 00 8A D0 80 EA 4B 32 D0 8A D8 02 DB 02 D3 02 D1 80 C2 2D 30 14 28 40 3B C7 72 E6|"; fast_pattern:only; reference:url,virustotal.com/en/file/aab148f9445f8ea69a6992a245037919b96c7b6457d35732f4171e371359aee5/analysis/; sid:39746; rev:1;)
alert tcp any any -> any 25 (msg:"MALWARE-OTHER Win.Ransomware.Sorebrect download attempt"; flow:to_server,established; file_data; content:"|25 00 00 FF 00 81 F1 00 00 00 01 81 E1 00 00 00 FF 33 C8 8B C3 C1 E8 18 0F B6 04 85 68 1C 41 00|"; fast_pattern:only; reference:url,virustotal.com/en/file/4142ff4667f5b9986888bdcb2a727db6a767f78fe1d5d4ae3346365a1d70eb76/analysis/; sid:43443; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"MALWARE-OTHER Win.Ransomware.Sorebrect download attempt"; flow:to_client,established; file_data; content:"|25 00 00 FF 00 81 F1 00 00 00 01 81 E1 00 00 00 FF 33 C8 8B C3 C1 E8 18 0F B6 04 85 68 1C 41 00|"; fast_pattern:only; reference:url,virustotal.com/en/file/4142ff4667f5b9986888bdcb2a727db6a767f78fe1d5d4ae3346365a1d70eb76/analysis/; sid:43442; rev:1;)
alert tcp any [139,445] -> any any (msg:"MALWARE-OTHER Win.Ransomware.Kristina encryption over SMB attempt"; flow:to_client,established; content:"|FF|SMB"; depth:4; offset:4; content:"|32|"; within:1; content:"p|00|r|00|o|00|t|00|o|00|n|00|m|00|a|00|i|00|l|00 2E 00|c|00|h|00 2E 00|c|00|r|00|y|00|p|00|t|00|1|00|2|00|"; fast_pattern:only;  reference:url,www.virustotal.com/#/file/2980f3d4b10436aeec95f5b96e52ac1248be6649d7cfa26bade4203fe1de88c7/detection;  sid:44982; rev:1;)
alert tcp any [139,445] -> any any (msg:"MALWARE-OTHER Win.Ransomware.Kristina encryption over SMB attempt"; flow:to_client,established; content:"|FE|SMB"; depth:4; offset:4; content:"|0E 00|"; within:2; distance:8; content:"p|00|r|00|o|00|t|00|o|00|n|00|m|00|a|00|i|00|l|00 2E 00|c|00|h|00 2E 00|c|00|r|00|y|00|p|00|t|00|1|00|2|00|"; fast_pattern:only;  reference:url,www.virustotal.com/#/file/2980f3d4b10436aeec95f5b96e52ac1248be6649d7cfa26bade4203fe1de88c7/detection;  sid:44981; rev:1;)
alert tcp any any -> any 445 (msg:"MALWARE-OTHER Win.Ransomware.Samsam upload attempt"; flow:to_server,established; content:"|00 00 0A 2C 08 06 16 9A 28|"; content:"|00 00 0A 02 16 9A 28 03 00 00 06 28|"; within:12; distance:1;  reference:url,www.virustotal.com/en/file/8eabfa74d88e439cfca9ccabd0ee34422892d8e58331a63bea94a7c4140cf7ab/analysis/;  sid:45486; rev:2;)
alert tcp any any -> any 445 (msg:"MALWARE-OTHER Win.Ransomware.Samsam propagation via SMB2 transfer attempt"; flow:to_server,established; content:"|FE|SMB"; depth:4; offset:4; content:"|05 00|"; within:2; distance:8; byte_jump:4,98,relative,little,from_beginning; content:".|00|s|00|t|00|u|00|b|00|b|00|i|00|n|00|"; within:16; distance:-18;  reference:url,www.virustotal.com/en/file/8eabfa74d88e439cfca9ccabd0ee34422892d8e58331a63bea94a7c4140cf7ab/analysis/;  sid:45485; rev:2;)
alert tcp any any -> any 445 (msg:"MALWARE-OTHER Win.Ransomware.Samsam propagation via SMB transfer attempt"; flow:to_server,established; content:"|FF|SMB|A2|"; depth:5; offset:4; content:".stubbin|00|"; fast_pattern:only;  reference:url,www.virustotal.com/en/file/8eabfa74d88e439cfca9ccabd0ee34422892d8e58331a63bea94a7c4140cf7ab/analysis/;  sid:45484; rev:2;)
lert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Unix.Trojan.PyCryptoMiner outbound connection"; flow:to_server,established; content:"/api"; depth:4; http_uri; content:"action=get&name=jboss"; fast_pattern:only; http_client_body;  reference:url,virustotal.com/file/d47d2aa3c640e1563ba294a140ab3ccd22f987d5c5794c223ca8557b68c25e0d/analysis/1519876147/;  sid:45956; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Modimer Trojanized MediaGet outbound connection"; flow:to_server,established; content:"video_associations="; fast_pattern:only; http_client_body; content:"/start.php"; http_uri; urilen:10;  reference:url,cloudblogs.microsoft.com/microsoftsecure/2018/03/13/poisoned-peer-to-peer-app-kicked-off-dofoil-coin-miner-outbreak/;  sid:46099; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"MALWARE-CNC Win.Downloader.Wannaminer malicious Powershell download attempt"; flow:established,to_client; file_data; content:"|24 66 61 3D 27 5A 6E 56 75 59 33 52 70 62 32 34 67 53 57 35 32 62 32 74 6C 4C 56 64 4E 53 55 56|"; fast_pattern:only;  reference:url,virustotal.com/en/file/3f287e29bcb10b200439626d97dd49521816c8dc847797f5acc7ebfe25b4efc4/analysis/;  sid:46202; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"MALWARE-CNC Bitvote miner kernel driver payload download attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"lKTD"; fast_pattern; content:"MZ"; within:50; content:"This program cannot be run in DOS mode"; within:200;  reference:url,virustotal.com/en/file/019426698cb1cc733024c38d0d09ff5dcac1ad9cf81d26c092a278f72f131e59/analysis/;  sid:46407; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Bitvote miner kernel driver outbound request attempt"; flow:to_server,established; content:"/dr.php"; fast_pattern:only; http_uri; content:"mid="; nocase; http_client_body; content:"agentid="; nocase; http_client_body; content:"idx="; nocase; http_client_body;  reference:url,virustotal.com/en/file/019426698cb1cc733024c38d0d09ff5dcac1ad9cf81d26c092a278f72f131e59/analysis/;  sid:46406; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"POLICY-OTHER CoinHive Miner client detected"; flow:to_client,established; file_data; content:".getHashesPerSecond|28|"; nocase; content:".getTotalHashes|28|"; nocase; content:".getAcceptedHashes|28|"; fast_pattern:only;  reference:url,coinhive.com/documentation/miner;  sid:45268; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"POLICY-OTHER CoinHive Miner Javascript library download detected"; flow:to_client,established; file_data; content:"Miner.prototype.getHashesPerSecond"; nocase; content:"Miner.prototype.getTotalHashes"; fast_pattern:only; content:"Miner.prototype.isMobile"; nocase;  reference:url,coinhive.com/documentation/miner;  sid:45267; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"POLICY-OTHER CoinHive Miner client detected"; flow:to_client,established; file_data; content:"new CoinHive.User"; fast_pattern:only; content:".start|28|"; nocase;  reference:url,coinhive.com/documentation/miner;  sid:45266; rev:3;)
alert tcp any $HTTP_PORTS -> any any (msg:"POLICY-OTHER cryptomining javascript client detected"; flow:to_client,established; file_data; content:".Anonymous|28|"; nocase; content:".start|28|"; within:200; nocase;  reference:url,coinhive.com/documentation/miner; reference:url,coinimp.com/documentation;  sid:45265; rev:5;)
alert tcp any any -> any any (msg:"PUA-OTHER XMRMiner cryptocurrency mining pool connection attempt"; flow:to_server,established; content:"|22|method|22|"; nocase; content:"|22|agent|22|"; nocase; content:"|22|XMRMiner"; fast_pattern:only;  reference:url,github.com/xmrig/xmrig;  sid:45955; rev:1;)
alert tcp any any -> any any (msg:"PUA-OTHER Cryptocurrency Miner outbound connection attempt"; flow:established,to_server; content:"|7B 22|id|22 3A|"; content:"|22|jsonrpc|22 3A|"; content:"|22|method|22 3A 22|login|22 2C 22|params|22 3A 7B 22|login|22 3A|"; content:"|22|pass|22 3A|"; content:"|22|agent|22 3A|";  reference:url,virustotal.com/en/file/2b83c69cf32c5f8f43ec2895ec9ac730bf73e1b2f37e44a3cf8ce814fb51f120/analysis;  sid:46237; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"PUA-OTHER Moonify Miner client detected"; flow:to_client,established; file_data; content:"Moonify.start"; fast_pattern:only;  reference:url,doc.moonify.io;  sid:46370; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"PUA-OTHER CoinHive Miner client detected"; flow:to_client,established; file_data; content:"ASMJS_NAME"; fast_pattern:only; content:"LIB_URL"; content:"WEBSOCKET";  reference:url,coinhive.com/documentation/miner;  sid:46365; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"PUA-OTHER Mineralt cryptocurrency mining attempt"; flow:to_client,established; file_data; content:"window._am.start()"; reference:url,mineralt.io;  sid:46414; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"PUA-OTHER Mineralt cryptocurrency mining attempt"; flow:to_client,established; file_data; content:"async class"; fast_pattern:only; pcre:"/\x3cscript\s+async\s+class\s*=\s*[\x27\x22].*?\x3b\d{2,3}\x3b[01][\x27\x22]/is";  reference:url,mineralt.io;  sid:46413; rev:1;)

#ssl_state keyword not supported by our snort
#alert tcp any 443 -> any any (msg:"PUA-OTHER Mineralt TLS server hello attempt"; flow:to_client,established; ssl_state:server_hello; content:"mineralt.io"; fast_pattern:only;   sid:46411; rev:1;)
#alert tcp any any -> any 443 (msg:"PUA-OTHER Mineralt TLS client hello attempt"; flow:to_server,established; ssl_state:client_hello; content:"mineralt.io"; fast_pattern:only;   sid:46410; rev:1;)

alert tcp any any -> any 23 (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise echo loader attempt"; flow:to_server,established; content:"echo -"; content:"e"; within:4;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40523; rev:2;)
alert tcp any any -> any [23,2323,5555,7547] (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise fingerprinting"; flow:to_server,established; content:"/bin/busybox "; fast_pattern:only;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40522; rev:3;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise download"; flow:to_server,established; content:"arm"; fast_pattern:only; http_uri; content:"Host: "; http_header; content:"."; within:4; http_header; content:"."; within:4; http_header; content:"."; within:4; http_header; content:"|0A|"; within:5; http_header; pcre:"/[\x2e\x5c\x2f\x2dyx]arm\d?$/U"; flowbits:set,trojan.mirai; flowbits:noalert;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40521; rev:6;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise download"; flow:to_server,established; content:"sh4"; fast_pattern:only; http_uri; content:"Host: "; http_header; content:"."; within:4; http_header; content:"."; within:4; http_header; content:"."; within:4; http_header; content:"|0A|"; within:5; http_header; pcre:"/[\x2e\x5c\x2f\x2dyx]sh4$/U"; flowbits:set,trojan.mirai; flowbits:noalert;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40520; rev:6;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise download"; flow:to_server,established; content:"mips"; fast_pattern:only; http_uri; content:"Host: "; http_header; content:"."; within:4; http_header; content:"."; within:4; http_header; content:"."; within:4; http_header; content:"|0A|"; within:5; http_header; pcre:"/[\x2e\x5c\x2f\x2dyx]mips$/U"; flowbits:set,trojan.mirai; flowbits:noalert;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40519; rev:6;)
alert tcp any any -> any 23 (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise activity"; flow:to_server,established; content:"wget"; fast_pattern:only; content:"curl"; nocase; content:"tftp"; nocase;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40601; rev:1;)
alert tcp any any -> any 23 (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise echo loader attempt"; flow:to_server,established; content:"|5C|177|5C|105|5C|114|5C|106"; fast_pattern:only;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40600; rev:1;)
alert tcp any any -> any 23 (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise echo loader attempt"; flow:to_server,established; content:"|5C|x7F|5C|x45|5C|x4C|5C|x46"; fast_pattern:only;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40599; rev:1;)
alert tcp any any -> any $HTTP_PORTS (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise download attempt"; flow:to_server,established; content:"/bins/mirai"; fast_pattern:only; http_uri;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:40612; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"MALWARE-CNC Unix.Trojan.Mirai variant post compromise download"; flow:to_client,established; flowbits:isset,trojan.mirai; file_data; content:"|7F|ELF"; depth:4;  reference:url,www.virustotal.com/en/file/22b45a675883c392e3ef271c53ec875a0a69e393a391f7aff6ff2d6809cd035f/analysis/;  sid:42113; rev:1;)

#May 21, 2018 - Dan R.
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"MALWARE-CNC Unix.Trojan.Vpnfilter variant outbound connection attempt"; flow:to_server,established; content:"User-Agent: Mozilla/5.0|0D 0A|Host: "; fast_pattern:only; http_header; content:"Accept: */*|0D 0A|Content-Type: application/x-www-form-urlencoded|0D 0A 0D 0A|"; http_header; content:!"Cookie:"; http_header; content:!"Referer:"; http_header; reference:url,virustotal.com/en/file/50ac4fcd3fbc8abcaa766449841b3a0a684b3e217fc40935f1ac22c34c58a9ec/analysis/;  sid:45564; rev:2;)
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any $HTTP_PORTS (msg:"MALWARE-CNC Unix.Trojan.Vpnfilter variant outbound connection attempt"; flow:to_server,established; content:"User-Agent: Mozilla/6.1 (compatible|3B| MSIE 9.0|3B| Windows NT 5.3|3B| Trident/5.0)|0D 0A|"; fast_pattern:only; http_header;  reference:url,virustotal.com/en/file/0e0094d9bd396a6594da8e21911a3982cd737b445f591581560d766755097d92/analysis/;  sid:45563; rev:2;)
alert udp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any 53 (msg:"MALWARE-OTHER DNS request for known malware domain toknowall.com - Unix.Trojan.Vpnfilter"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|09|toknowall|03|com|00|"; fast_pattern:only;  reference:url,www.virustotal.com/en/domain/toknowall.com/information/; sid:46807; rev:2;)

#Jul 12, 2018 - Dan R
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Thanatos"; flow:to_server,established; content:"User-Agent|3A| Mozilla/5.0 (Windows NT 6.1) Thanatos/1.1"; fast_pattern:only; http_header; reference:url,www.virustotal.com/#/file/fe1eafb8e31a84c14ad5638d5fd15ab18505efe4f1becaa36eb0c1d75cd1d5a9; sid:45816; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Matrix"; flow:to_server,established; content:"add.php?apikey="; http_uri; content:"&compuser="; http_uri; content:"&sid="; http_uri; content:"&phase="; http_uri; reference:url,"www.virustotal.com/#/file/996ea85f12a17e8267dcc32eae9ad20cff44115182e707153006162711fbe3c9/detection"; sid:46339; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] $HTTP_PORTS (msg:"MALWARE-CNC Dharma.Ransomware.Dropper"; flow:to_server,established; content:"/infolan.php"; fast_pattern:only; http_uri; content:"|7B 22|LanCnt|22 3A|"; depth:10; http_client_body; reference:url,virustotal.com/en/file/d913558f256224e6352b12cb6137ad8a789670b6c4d3a3a665ba8a0b961b2828/analysis/; sid:46796; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] $HTTP_PORTS (msg:"MALWARE-CNC Dharma.Ransomware.Dropper"; flow:to_server,established; content:"User-Agent|3A| infobot|0D 0A|"; fast_pattern:only; http_header; content:"|22|userpass|22|"; http_client_body; content:"|22|bits|22|"; http_client_body; content:"|22|disk|22|"; http_client_body; reference:url,virustotal.com/en/file/a39af09bf65d8942d0c943151cdde8c04b302c5c0b115ab80759e226b50e743b/analysis/; sid:46795; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] $HTTP_PORTS (msg:"MALWARE-CNC Win.Ransomware.Satan"; flow:to_server,established; content:"/data/token.php"; fast_pattern:only; http_uri; content:"status="; nocase; http_uri; content:"code="; nocase; http_uri; content:"Winnet Client"; nocase; http_header; reference:url,www.virustotal.com/en/file/b686cba1894f8ab5cec0ce5db195022def00204f6cd143a325608ec93e8b74ee/analysis/; sid:46818; rev:1;)
alert tcp any $HTTP_PORTS -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"MALWARE-OTHER MacOSXFBI.Ransomware"; flow:to_client,established; file_data; content:"<iframe src=|22|YOUR|25|20BROWSER|25|20HAS|25|20BEEN|25|20LOCKED"; fast_pattern:only; reference:url,blog.malwarebytes.org/intelligence/2013/07/fbi-ransomware-now-targeting-apples-mac-os-x-users/; sid:27246; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"MALWARE-OTHER Win.Ransomware.Thanatos"; flow:to_server; flowbits:isset,file.exe; file_data; content:"Release|5C|Thanatos.pdb"; fast_pattern:only; reference:url,www.virustotal.com/#/file/fe1eafb8e31a84c14ad5638d5fd15ab18505efe4f1becaa36eb0c1d75cd1d5a9; sid:45818; rev:1;)
alert tcp any any -> any any (msg:"MALWARE-OTHER Win.Ransomware.MBRLock file download"; flow:to_server,established; file_data; content:"woshixiaoxuesheng"; fast_pattern; content:"taskkill"; distance:-150; nocase; content:"password"; within:150; nocase; content:"PhysicalDrive"; nocase; reference:url,virustotal.com/en/file/dfc56a704b5e031f3b0d2d0ea1d06f9157758ad950483b44ac4b77d33293cb38/analysis/; sid:46989; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"MALWARE-OTHER Win.Ransomware.Annabelle"; flow:to_client,established; file_data; content:"PhysicalDrive"; fast_pattern:only; content:"|6A 00 6A 00 6A 03 6A 00 6A 03 68 00 00 00 10|"; content:"|6A 00 8D 45 EC 50 68 00 80 00 00 8D 85 E4|"; within:50; content:"taskkill"; content:"shutdown"; within:50;  reference:url,virustotal.com/en/file/7a243bcbff4309eafd287ecc124606171724da76fc3c1896002e5f7392b13df3/analysis/; sid:46986; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] $HTTP_PORTS (msg:"MALWARE-CNC Win.Trojan.Modimer"; flow:to_server,established; content:"video_associations="; fast_pattern:only; http_client_body; content:"/start.php"; http_uri; urilen:10; reference:url,cloudblogs.microsoft.com/microsoftsecure/2018/03/13/poisoned-peer-to-peer-app-kicked-off-dofoil-coin-miner-outbreak/; sid:46099; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"MALWARE-CNC Win.Downloader.Wannaminer.Powershell.Downloader"; flow:established,to_client; file_data; content:"|24 66 61 3D 27 5A 6E 56 75 59 33 52 70 62 32 34 67 53 57 35 32 62 32 74 6C 4C 56 64 4E 53 55 56|"; fast_pattern:only; reference:url,virustotal.com/en/file/3f287e29bcb10b200439626d97dd49521816c8dc847797f5acc7ebfe25b4efc4/analysis/; sid:46202; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] $HTTP_PORTS (msg:"MALWARE-CNC Bitvote.Miner.Kernel.Driver"; flow:to_server,established; content:"/dr.php"; fast_pattern:only; http_uri; content:"mid="; nocase; http_client_body; content:"agentid="; nocase; http_client_body; content:"idx="; nocase; http_client_body; reference:url,virustotal.com/en/file/019426698cb1cc733024c38d0d09ff5dcac1ad9cf81d26c092a278f72f131e59/analysis/; sid:46406; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"MALWARE-CNC Js.Downloader.Cryptojacking.Miner"; flow:to_client,established; file_data; content:"[|22 5C|x69|5C|x64|22|]=|27||5C|x6d|5C|x5f|5C|x67|5C|x5f|5C|x61|27|"; fast_pattern:only; reference:url,virustotal.com/#/file/b672224d6d3776da343ae0e15c32815082aa514805b5efe47fb2c678c861d534/detection; sid:46946; rev:1;)
alert tcp any $HTTP_PORTS -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"POLICY-OTHER CoinHive.Miner.Client"; flow:to_client,established; file_data; content:".getHashesPerSecond|28|"; nocase; content:".getTotalHashes|28|"; nocase; content:".getAcceptedHashes|28|"; fast_pattern:only; reference:url,coinhive.com/documentation/miner; sid:45268; rev:3;)
alert tcp any $HTTP_PORTS -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"POLICY-OTHER CoinHive.Miner.Javascript.Library.Download"; flow:to_client,established; file_data; content:"Miner.prototype.getHashesPerSecond"; nocase; content:"Miner.prototype.getTotalHashes"; fast_pattern:only; content:"Miner.prototype.isMobile"; nocase; reference:url,coinhive.com/documentation/miner; sid:45267; rev:3;)
alert tcp any $HTTP_PORTS -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"POLICY-OTHER CoinHive.Miner.Client"; flow:to_client,established; file_data; content:"new CoinHive.User"; fast_pattern:only; content:".start|28|"; nocase; reference:url,coinhive.com/documentation/miner; sid:45266; rev:3;)
alert tcp any $HTTP_PORTS -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"POLICY-OTHER Cryptomining.Javascript.Client"; flow:to_client,established; file_data; content:".Anonymous|28|"; nocase; content:".start|28|"; within:200; nocase; reference:url,coinhive.com/documentation/miner; reference:url,coinimp.com/documentation; sid:45265; rev:5;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"PUA-OTHER XMRMiner.Cryptocurrency"; flow:to_server,established; content:"|22|method|22|"; nocase; content:"|22|agent|22|"; nocase; content:"|22|XMRMiner"; fast_pattern:only; reference:url,github.com/xmrig/xmrig; sid:45955; rev:1;)
alert tcp any $HTTP_PORTS -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"INDICATOR-COMPROMISE Metasploit.Powershell"; flow:to_client,established; file_data; content:"|5C|v1.0|5C|powershell.exe"; content:"New-Object System.Diagnostics.ProcessStartInfo"; fast_pattern:only; content:".FileName="; content:".Arguments="; content:".UseShellExecute="; content:".RedirectStandardOutput="; sid:45137; rev:2;)
alert tcp any $HTTP_PORTS -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"INDICATOR-COMPROMISE Metasploit.PowerShell.Run"; flow:to_client,established; file_data; content:"<?XML"; depth:5; content:"powershell.exe"; content:"new-object Net.WebClient|29|.DownloadString"; fast_pattern:only; sid:45136; rev:2;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] 80 (msg:"MALWARE-BACKDOOR Win.Backdoor.Cobrike.Outbound"; flow:to_server,established; content:"Windows PowerShell running as user"; fast_pattern; content:"|0A|Copyright (C) 2015 Microsoft Corporation. All rights reserved.|0A 0A|"; within:150; flowbits:set,backdoor.powershell; reference:url,virustotal.com/en/file/a3b52cba0783b856f93e593fbaae4fb8bd75b3a6e22426e82f4dbd45bab2bc77/analysis/; sid:35770; rev:3;)
alert tcp any 80 -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"MALWARE-BACKDOOR Win.Backdoor.Cobrike.Inbound"; flow:to_client,established; flowbits:isset,backdoor.powershell; content:"powerfun"; fast_pattern:only; nocase; reference:url,virustotal.com/en/file/a3b52cba0783b856f93e593fbaae4fb8bd75b3a6e22426e82f4dbd45bab2bc77/analysis/; sid:35769; rev:4;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"MALWARE-BACKDOOR CobaltStrike.Inbound.Download"; flow:to_client; file_data; content:"powershell -nop -exec bypass -EncodedCommand |22|%s|22|"; fast_pattern:only; content:"char c = (i & 0xFF)|3B|"; nocase; reference:url,colbaltstrike.com; sid:45904; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"MALWARE-OTHER Win.Trojan.PowerShell.Gen.Inbound"; flow:to_client,established; file_data; content:"powershell"; nocase; content:"-Exec"; nocase; content:"Sleep"; nocase; content:"taskkill"; nocase; content:"iexplore"; nocase; reference:url,virustotal.com/en/file/0CF2C0165CDC3962AD8C3AC27258FDAB4DCECB7121BA97856B66D22FD77AEFCA/analysis/; sid:397555; rev:1;)
alert tcp any any -> [!10.0.0.0/8,!172.16.0.0/12,!192.168.0.0/16] any (msg:"MALWARE-OTHER Win.Trojan.PowerShell.Gen.Outbound"; flow:to_server,established; file_data; content:"powershell"; nocase; content:"-Exec"; nocase; content:"Sleep"; nocase; content:"taskkill"; nocase; content:"iexplore"; nocase; reference:url,virustotal.com/en/file/0CF2C0165CDC3962AD8C3AC27258FDAB4DCECB7121BA97856B66D22FD77AEFCA/analysis/; sid:397556; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"OS-WINDOWS Win32k.EoP"; flow:to_client,established; file_data; content:"|65 48 8B 04 25 30 00 00 00 48 C7 80 60 08 00 00 00 FF FF FF 45 33 C9 48 8D 4C 24 20 45 33 C0 33|"; fast_pattern:only; reference:cve,2018-8233; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8233; sid:46938; rev:1;)
alert tcp any $HTTP_PORTS -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"FILE-OTHER Microsoft Windows.Host.Compute.Service.Shim.RCE"; flow:to_client,established; file_data; content:"|00 00|Files|5C|../../../../../../../../"; fast_pattern:only;  reference:cve,2018-8115; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8115; sid:46811; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS (msg:"SERVER-WEBAPP Multiple products DVR admin password leak attempt"; flow:to_server,established; content:"/device.rsp"; fast_pattern:only; http_uri; content:"uid="; http_raw_cookie; content:"cmd=list"; reference:cve,2018-9995; sid:46825; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] $HTTP_PORTS (msg:"SERVER-WEBAPP Axis.M3004.RCE"; flow:to_server,established; content:"/onvif/device_service"; fast_pattern:only; http_uri; content:"<?"; isdataat:64,relative; content:!"?"; within:64; reference:cve,2017-9765; sid:43625; rev:2;)


##### research rules end 
